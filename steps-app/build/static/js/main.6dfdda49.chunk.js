(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{358:function(e,t,a){e.exports=a(819)},363:function(e,t,a){},365:function(e,t,a){},405:function(e,t){},407:function(e,t){},438:function(e,t){},439:function(e,t){},487:function(e,t){},489:function(e,t){},510:function(e,t){},819:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(36),s=a.n(i),r=(a(363),a(8)),l=a(9),c=a(11),d=a(10),u=a(12),m=a(824),h=a(825),p=(a(365),a(24)),g=a.n(p),f=g.a.createActions(["displayOSMBaseMap"]),b=a(356),I=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={},e.listenables=f,e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onDisplayOSMBaseMap",value:function(e){var t=Object(b.a)(e,2),a=t[0],n=t[1],o=new a({basemap:"osm"}),i=new n({map:o,container:"mapContainer",basemap:"osm",center:[-113.499,53.5405],zoom:15});this.setState({map:o,view:i})}}]),t}(g.a.Store),w=a(343),v=a.n(w),y={url:"https://js.arcgis.com/4.9"},O=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={},e.store=I,e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadOSMBaseMap()}},{key:"loadOSMBaseMap",value:function(){v.a.loadModules(["esri/Map","esri/views/MapView"],y).then(f.displayOSMBaseMap).catch(function(e){console.error(e)})}},{key:"render",value:function(){return o.a.createElement("div",{id:"mapContainer"})}}]),t}(p.Component),E=a(820),j=g.a.createActions(["uploadSidewalkImage","loadUploadedImages","loadSidewalkDetails"]),k=a(209),S=a.n(k),C=6291456,N=function(e){return"".concat("http://199.116.235.159:8000","/api/").concat(e,"/")},R=function(){function e(){Object(r.a)(this,e)}return Object(l.a)(e,null,[{key:"sendPostRequest",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object.assign({uri:N(e),headers:{"Content-Type":"application/json"},json:!0,method:"POST",body:t},a);return S.a.post(n)}},{key:"sendGetRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object.assign({uri:N(e),json:!0,qs:t},a);return S.a.get(n)}}]),e}(),x=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={loadedUserImages:[],hasNextImagesPage:!0,currentSidewalk:null,uploadingSidewalkImage:!1,uploadedImageError:!1},e.listenables=j,e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onLoadSidewalkDetails",value:function(e){this.setState({currentSidewalk:e})}},{key:"onUploadSidewalkImage",value:function(e){var t=this;this.setState({uploadingSidewalkImage:!0,uploadedImageError:!1}),R.sendPostRequest("sidewalk/".concat(this.state.currentSidewalk,"/image/create"),{image:e}).then(function(){t.setState({uploadingSidewalkImage:!1,uploadedImageError:!1})}).catch(function(e){t.setState({uploadingSidewalkImage:!1,uploadedImageError:!0}),console.error(e)})}},{key:"onLoadUploadedImages",value:function(e,t,a){var n=this;R.sendPostRequest("sidewalk/".concat(this.state.currentSidewalk,"/image"),{startIndex:e,endIndex:t}).then(function(e){n.setState({hasNextImagesPage:e.hasMoreImages,loadedUserImages:n.state.loadedUserImages.slice(0).concat(e.images)}),a()}).catch(function(e){console.error(e)})}}]),t}(g.a.Store),_=a(822),M=a(826),P=function(e){return new Promise(function(t,a){var n=new FileReader;n.onerror=function(e){n.abort(),a(e)},n.onload=function(){t(this.result)},n.readAsDataURL(e)})},B=a(823),L=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"row"},o.a.createElement(B.a,{readOnly:!0,type:"text",placeholder:this.props.fileName||"No file selected"}),o.a.createElement(M.a,{onClick:function(){return e.fileInput.click()},bsStyle:"primary"},o.a.createElement("div",null,o.a.createElement("input",{type:"file",accept:"image/*",onChange:this.props.onSelect,className:"uploadImageInput",ref:function(t){e.fileInput=t}}),o.a.createElement("span",{className:"imageComponentButtonText"},"Choose File"))))}}]),t}(o.a.Component),z=a(347),U=a.n(z),F=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(U.a,null)}}]),t}(o.a.Component),D=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e)))._selectImageToUpload=function(e){var t=e.target.files[0];t&&t.size<=C?(a.setState({loadingSelectedImage:!0,selectedImageSize:null,selectedImage:null,selectedFileName:t.name}),P(t).then(function(e){a.setState({selectedImage:e,selectedImageSize:t.size,loadingSelectedImage:!1})})):(!a.state.selectedImage||t&&t.size>C)&&a.setState({selectedImageSize:t&&t.size,selectedImage:null,selectedFileName:t&&t.name,loadingSelectedImage:!1})},a._shouldDisplaySizeWarning=function(){return Boolean(a.state.selectedImageSize&&a.state.selectedImageSize>C)},a._canUpload=function(){return Boolean(a.state.selectedImage&&a.state.selectedImageSize<=C)},a._cancel=function(){a.setState({selectedImage:null,selectedImageSize:null,selectedFileName:null,loadingSelectedImage:!1}),a.props.onClose()},a._confirmUpload=function(){a.props.onClose(a.state.selectedImage.split(";base64,")[1]),a.setState({selectedImage:null,selectedImageSize:null,selectedFileName:null,loadingSelectedImage:!1})},a.state={},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(_.a,{show:this.props.visible,onHide:this._cancel},o.a.createElement(_.a.Header,null,o.a.createElement(_.a.Title,null,"Upload Image")),o.a.createElement(_.a.Body,null,this._shouldDisplaySizeWarning()&&o.a.createElement(E.a,{bsStyle:"danger"},"That image is too large. The selected image should be no more than ",Math.floor(C/1048576)," megabytes."),o.a.createElement(L,{onSelect:this._selectImageToUpload,fileName:this.state.selectedFileName}),this.state.selectedImage&&o.a.createElement("div",{className:"selectedImagePreview"},o.a.createElement("img",{className:"img-responsive",alt:"selected",src:this.state.selectedImage})),this.state.loadingSelectedImage&&o.a.createElement(F,null)),o.a.createElement(_.a.Footer,null,o.a.createElement(M.a,{onClick:this._cancel},"Cancel"),o.a.createElement(M.a,{bsStyle:"primary",onClick:this._confirmUpload,disabled:!this._canUpload()},"Upload")))}}]),t}(o.a.Component),T=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(M.a,{bsStyle:"primary",onClick:this.props.onClick},o.a.createElement("span",{className:"glyphicon glyphicon-camera"}),o.a.createElement("span",{className:"uploadSidewalkImageText"},"Upload Image"))}}]),t}(o.a.Component),A=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"col-md-12",onClick:this.props.onClick},o.a.createElement("div",{className:"pull-left"},o.a.createElement("img",{src:this.props.previewImage,alt:"preview"})),o.a.createElement("div",{className:"pull-left"},"View Images"))}}]),t}(o.a.Component),W=a(211),q=a.n(W),H=a(351),G=a.n(H),K=a(349),J=a.n(K),V=a(350),Y=a.n(V),$=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).listRef=o.a.createRef(),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(){this.listRef.current.forceUpdateGrid()}},{key:"render",value:function(){var e=this,t=this.props.hasNextPage?this.props.loadedItemCount+1:this.props.loadedItemCount;return o.a.createElement(J.a,{isRowLoaded:this.props.isRowLoaded,loadMoreRows:this.props.loadMoreRows,rowCount:t},function(a){var n=a.onRowsRendered;return o.a.createElement(Y.a,{ref:e.listRef,height:1e3,onRowsRendered:n,rowCount:t,rowHeight:160,rowRenderer:e.props.rowRenderer,width:250})})}}]),t}(o.a.PureComponent),Q=(a(756),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e)))._onResize=function(){a.props.visible&&a.forceUpdate()},a._onImageClicked=function(e){a.setState({currentImageIndex:e})},a._isRowLoaded=function(e){var t=e.index;return Boolean(a.props.loadedImages[t])},a._loadMoreRows=function(e){var t=e.startIndex,n=e.stopIndex;t||(n=(t=a.props.loadedImages.length)+1),a.props.loadMoreData(t,n)},a._rowRenderer=function(e){var t,n=e.index,i=e.key,s=e.style;return t=a._isRowLoaded({index:n})?o.a.createElement("div",{onClick:function(){a._onImageClicked(n)},className:a.state.currentImageIndex===n?"infiniteImageRowSelected":"infiniteImageRowUnselected"},o.a.createElement("img",{className:"img-responsive",alt:"uploaded",width:140,src:a.props.loadedImages[n].url})):o.a.createElement(F,null),o.a.createElement("div",{className:"infiniteImageListRow",key:i,style:s},t)},a._handleKeyDown=function(e){"ArrowRight"===e.key||"ArrowDown"===e.key?(a.state.currentImageIndex===a.props.loadedImages.length-1&&a._loadMoreRows({startIndex:a.state.currentImageIndex+1,endIndex:a.state.currentImageIndex+1}),a.setState({currentImageIndex:a.state.currentImageIndex+1})):("ArrowLeft"===e.key||"ArrowUp"===e.key)&&a.state.currentImageIndex>0?a.setState({currentImageIndex:a.state.currentImageIndex-1}):"Escape"===e.key&&a.props.onClose()},a.state={currentImageIndex:0},a.selfRef=o.a.createRef(),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this._onResize)}},{key:"componentDidUpdate",value:function(e){e.visible!==this.props.visible&&this.props.visible&&this.selfRef.current.focus()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._onResize)}},{key:"renderSelectedImage",value:function(){var e;return e=this.props.loadedImages[this.state.currentImageIndex]?o.a.createElement("img",{className:"backgroundImage",alt:"selected",src:this.props.loadedImages[this.state.currentImageIndex].url}):o.a.createElement(F,null),o.a.createElement("div",{style:{width:window.innerWidth-250},className:"selectedImageWrapper"},e)}},{key:"render",value:function(){return o.a.createElement("div",{tabIndex:0,onKeyDown:this._handleKeyDown,ref:this.selfRef,className:"noOutlineDiv"},o.a.createElement(q.a,{open:this.props.visible,variant:"persistent",onClose:this.props.onClose,anchor:"left"},this.renderSelectedImage()),o.a.createElement(q.a,{open:this.props.visible,variant:"persistent",onClose:this.props.onClose,anchor:"right"},o.a.createElement(G.a,{className:"closeImageListButton",onClick:this.props.onClose}),o.a.createElement($,{isRowLoaded:this._isRowLoaded,loadMoreRows:this.props.isNextPageLoading?function(){}:this._loadMoreRows,rowRenderer:this._rowRenderer,hasNextPage:this.props.hasNextPage,loadedItemCount:this.props.loadedImages.length})))}}]),t}(o.a.Component)),X=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e)))._loadMoreImages=function(e,t){a.setState({isNextPageLoading:!0}),j.loadUploadedImages(e,t,function(){a.setState({isNextPageLoading:!1})})},a.store=x,a.state={isNextPageLoading:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(Q,{loadedImages:this.state.loadedUserImages,hasNextPage:this.state.hasNextImagesPage,loadMoreData:this._loadMoreImages,visible:this.props.visible,isNextPageLoading:this.state.isNextPageLoading,onClose:this.props.onClose})}}]),t}(g.a.Component),Z=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e)))._openImageModal=function(){a.setState({modalOpened:!0})},a._closeImageModal=function(e){a.setState({modalOpened:!1}),e&&j.uploadSidewalkImage(e)},a._viewImages=function(){a.setState({viewingImages:!0})},a._closeImages=function(){a.setState({viewingImages:!1})},a.state={modalOpened:!1,viewingImages:!1},a.store=x,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(T,{onClick:this._openImageModal}),this.state.uploadedImageError&&o.a.createElement(E.a,{bsStyle:"danger"},"An error occurred while uploading the image."),this.state.uploadingSidewalkImage&&o.a.createElement("div",null,o.a.createElement("span",null,"Uploading"),o.a.createElement(F,null)),o.a.createElement(A,{previewImage:"",onClick:this._viewImages}),o.a.createElement(D,{visible:this.state.modalOpened,onClose:this._closeImageModal}),o.a.createElement(X,{onClose:this._closeImages,visible:this.state.viewingImages}))}}]),t}(p.Component),ee=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={sidewalkOpened:!0},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(O,null),this.state.sidewalkOpened&&o.a.createElement(Z,null))}}]),t}(p.Component),te=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"renderCategory",value:function(e,t){return o.a.createElement("div",null,o.a.createElement("h3",null,e),o.a.createElement("p",null,t),o.a.createElement("hr",null))}},{key:"render",value:function(){return o.a.createElement("div",{className:"padding25"},this.renderCategory("What is this website about?","This website was made for the purpose of allowing the citizens of Edmonton to discuss \n\t\t\t\t\ttheir experiences on sidewalks across the city with other people. As a user of this site, you are able to select any\n\t\t\t\t\tsidewalk in the city from the map displayed on the home page. By selecting a sidewalk, you will be\n\t\t\t\t\tshown what other people think about that particular sidewalk, through ratings, images, and comments.\n\t\t\t\t\tYou can leave your own ratings and comments on the sidewalk, as well as upload any image that you\n\t\t\t\t\tfeel is relevant to the sidewalk."),this.renderCategory("Who will use the results?","\n\t\t\t\tThe results will primarily be used by two parties. The first one is government officials, so they can see\n\t\t\t\twhat sidewalks in the city are in need of improvement the most. STEPS researchers will also use the data collected\n\t\t\t\tfrom this website so that they can analyze it to get a bigger picture of the overall state of sidewalks\n\t\t\t\tin Edmonton.\n\t\t\t\t"),this.renderCategory("How can I get involved?","\n\t\t\t\tAll you need to do to be involved with the STEPS application is to leave your feelings and thoughts\n\t\t\t\tabout particular sidewalks. You can rate any sidewalk you want, comment on it, or even upload an image to it.\n\t\t\t\t"),this.renderCategory("Privacy Policy","\n\t\t\t\tAll of the data collected on this site will be used purely for research purposes. We will never sell any of the\n\t\t\t\tdata we collect to third parties, and nothing that you upload to the site will be directly linked back to you.\n\t\t\t\tAll of your interactions with the site will be anonymous.\n\t\t\t\t"))}}]),t}(o.a.Component),ae=a(118),ne=a(352),oe=a.n(ne),ie=a(353),se=a.n(ie),re=a(93),le=a.n(re),ce=g.a.createActions(["placeholderAction"]),de=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={isLoggedIn:!1},e.listenables=ce,e}return Object(u.a)(t,e),t}(g.a.Store),ue={root:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20},button:{fontSize:14,"&:hover":{color:"#FFEB3B"},"&:focus":{color:"#FFEB3B"}},titleButton:{fontSize:18,"&:hover":{color:"#FFEB3B"},"&:focus":{color:"#FFEB3B"},fontFamily:"Proza Libre"}},me=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).store=de,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.root},o.a.createElement(oe.a,{position:"static"},o.a.createElement(se.a,null,o.a.createElement(le.a,{color:"inherit",className:e.titleButton,href:"/"},"STEPS"),o.a.createElement(le.a,{color:"inherit",className:e.button,href:"/about"},"About"),o.a.createElement(le.a,{color:"inherit",className:e.button,href:"/statistics"},"Statistics"),!this.state.isLoggedIn&&o.a.createElement(le.a,{color:"inherit",className:e.button,href:"/login"},"Login"),this.state.isLoggedIn&&o.a.createElement(le.a,{color:"inherit",className:e.button,href:"/dashboard"},"Dashboard"))))}}]),t}(g.a.Component),he=Object(ae.withStyles)(ue)(me),pe=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(he,null),o.a.createElement(m.a,null,o.a.createElement(h.a,{path:"/about/",component:te}),o.a.createElement(h.a,{path:"/statistics",component:ee}),o.a.createElement(h.a,{path:"/login",component:ee}),o.a.createElement(h.a,{path:"/map/:id",component:ee}),o.a.createElement(h.a,{path:"/dashboard",component:ee}),o.a.createElement(h.a,{path:"/",component:ee})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ge=a(821),fe=a(355),be=a.n(fe),Ie=Object(ae.createMuiTheme)({palette:{primary:be.a,secondary:{main:"#FFEB3B"}}});s.a.render(o.a.createElement(ge.a,null,o.a.createElement(ae.MuiThemeProvider,{theme:Ie},o.a.createElement(pe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[358,2,1]]]);
//# sourceMappingURL=main.6dfdda49.chunk.js.map