{"version":3,"sources":["map/MapActions.js","constants/ArcGISConstants.js","constants/DatabaseConstants.js","util/RestUtil.js","map/MapStore.js","map/MapFilterModal.jsx","map/SummaryMapView.jsx","sidewalk/SidewalkActions.js","sidewalk/SidewalkStore.js","admin/AdminActions.js","constants/AdminConstants.js","util/SpamUtil.js","admin/AdminStore.js","util/DateUtilities.js","sidewalk/comments/SidewalkCommentComponent.jsx","misc-components/LoaderComponent.jsx","misc-components/ConfirmationModal.jsx","sidewalk/comments/CommentDeletionModal.jsx","constants/CommentConstants.js","sidewalk/comments/CommentsListComponent.jsx","util/FileUtilities.js","images/ImageSelectorComponent.jsx","images/ImageUploadModal.jsx","sidewalk/images/UploadSidewalkImageComponent.jsx","sidewalk/images/PreviewSidewalkImagesComponent.jsx","sidewalk/images/SidewalkImageDetailsComponent.jsx","sidewalk/PedestrianDataComponent.jsx","constants/ThemeConstants.js","util/RatingUtil.js","sidewalk/SidewalkRatingsModal.jsx","constants/RatingsDescriptionConstants.js","sidewalk/SidewalkDetailsView.jsx","sidewalk/images/ImageDeletionModal.jsx","images/InfiniteImageGalleryCarousel.jsx","sidewalk/images/SidewalkUploadedImagesGallery.jsx","misc-components/BaseAlertComponent.jsx","misc-components/ErrorAlertComponent.jsx","sidewalk/images/UploadedImageErrorComponent.jsx","misc-components/SuccessAlertComponent.jsx","sidewalk/images/UploadedImageSuccessComponent.jsx","sidewalk/comments/CommentDeleteSuccessComponent.jsx","sidewalk/comments/CommentDeleteErrorComponent.jsx","sidewalk/images/ImageDeleteErrorComponent.jsx","sidewalk/images/ImageDeleteSuccessComponent.jsx","sidewalk/comments/CommentPostSuccessComponent.jsx","sidewalk/comments/CommentPostErrorComponent.jsx","sidewalk/PostRatingSuccessComponent.jsx","sidewalk/PostRatingErrorComponent.jsx","sidewalk/PostRatingSameSidewalk.jsx","sidewalk/PostRatingThirtyComponent.jsx","sidewalk/comments/PostCommentingSameSidewalk.jsx","sidewalk/comments/PostCommentingThirtyComponent.jsx","map/AlertsContainer.jsx","map/MapDashboard.jsx","misc-components/AboutPageView.jsx","admin/PendingImagesGallery.jsx","admin/AdminPanelView.jsx","misc-components/NavbarComponent.jsx","admin/AdminLogin.jsx","summary/SummaryStatisticsActions.js","summary/SummaryStatisticsStore.js","summary/SummaryStatisticsView.jsx","App.js","serviceWorker.js","index.js"],"names":["Actions","Reflux","createActions","esriURL","url","downtownLongitude","downtownLatitude","sidewalkColorMapRenderer","type","field","defaultSymbol","uniqueValueInfos","value","symbol","width","color","style","highlightOptions","fillOpacity","MAX_UPLOAD_SIZE","makeRequestURL","endpoint","concat","RestUtil","body","optionOverrides","arguments","length","undefined","options","Object","assign","uri","headers","Content-Type","json","method","rp","post","query","qs","get","MapStore","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","sidewalks","sidewalkSelected","longitude","latitude","mapFilters","searchVisible","listenables","sidewalk","view","goTo","center","animate","duration","easing","setState","selectedSidewalkDetails","console","error","_this2","sendGetRequest","then","res","catch","err","open","_this3","esriLoader","loadModules","data","Map","MapView","Search","BasemapToggle","map","basemap","container","zoom","toggle","nextBasemap","ui","add","search","FeatureLayer","Circle","Legend","Expand","featureLayer","renderer","definitionExpression","window","when","legend","layerInfos","layer","title","expandLegend","content","updateView","isMobile","toAdd","toRemove","remove","setLegendMobile","widthBreakpoint","watch","breakpoint","on","event","sidewalkGPSAdress","pxToMeters","extent","popupEnabled","popup","dockEnabled","visible","dockOptions","buttonEnabled","popupTemplate","c","mapPoint","radius","clear","activeSource","locator","locationToAddress","response","address","split","q","createQuery","geometry","queryFeatures","results","features","sidewalkID","parseInt","attributes","osm_id","find","s","id","viewSidewalkDetails","strTrait","strEquality","strNumberSelect","dbTrait","newMapFilters","push","trait","operator","index","splice","onFilterMap","filter","join","_this4","updatedSidewalks","slice","selectedSidewalk","accessibility","overallRating","comfort","connectivity","physicalSafety","senseOfSecurity","_this5","result","feature","Store","TRAITS","OPERATORS","VALUES","TRAIT_MAP","Overall","Sense of Security","Accessibility","Connectivity","Comfort","Physical Safety","MapFilterModal","handleAddFilterEvent","addFilter","selectedTrait","selectedOperator","selectedValue","handleClearFilterEvent","clearFilters","_handleTraitChange","e","target","_handleOperatorChange","_handleValueChange","_expand","isExpanded","_minimize","_getModalStyle","opacity","_getMinimizedModalStyle","store","react_default","a","createElement","className","i","key","Close_default","onClick","removeFilter","name","values","selected","onChange","FormGroup","controlId","ControlLabel","FormControl","componentClass","placeholder","renderSelect","Button","bsStyle","bsSize","renderTable","disabled","filterMap","renderModalContent","Component","SummaryMapView","props","handleApplyFilterEvent","filterTable","document","getElementById","rateTraitObj","equalitySelectorObj","numberSelectorObj","selectedIndex","text","pushArray","rowCount","rows","row","insertRow","cell1","cells","insertCell","cell2","cell3","innerHTML","deleteRow","loadMapDetails","MapFilterModal_MapFilterModal","React","SidewalkStore","_getDefaultSidewalkState","loadedUserImages","hasNextImagesPage","currentSidewalk","uploadingSidewalkImage","uploadedImageError","uploadingComment","uploadCommentFailed","uploadImageSucceeded","ratingStatus","sameSidewalkRatingError","thirtySecondRatingError","hasNextCommentsPage","sidewalkHasCSVData","commentOneSidewalk","thirtyCommentSuspend","isNextImagePageLoading","newSidewalk","comments","lastImage","base64Image","sendPostRequest","image","startIndex","stopIndex","updateStateCallback","endIndex","hasMoreImages","images","comment","uploadCommentSucceeded","currentSidewalkComments","unshift","onSuccess","_this6","isUploadingRatings","successfullyUploadedRatings","failedUploadingRatings","parseFloat","synchronizeSidewalk","indexOf","newTotalComments","totalComments","onLastImageDeleted","onNoImagesRemaining","newImagesCount","totalImages","newImages","sidewalkOverride","_this7","hasMoreComments","successCallback","_this8","_this9","outFields","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","matchingSidewalk","Math","round","AvgOverall","AvgAccessibility","AvgComfort","AvgConnectivity","AvgSecurity","AvgSafety","edits","updateFeatures","applyEdits","return","sidewalkId","_this10","allSidewalkObjects","singleSidewalkData","forEach","ratings","sidewalkCSVInfo","sidewalkCsvFormatted","LOCAL_STORAGE_NAME","SUSPENSION_COOKIE","COOKIE_EXPIRE_TIME","MAX_LOGIN_ATTEMPTS","SpamUtil","localStorage","Number","setItem","removeItem","cname","cvalue","minute","pathValue","d","Date","setTime","getTime","expires","toUTCString","cookie","ca","decodeURIComponent","charAt","substring","AdminStore","isLoggedIn","isDeletingComment","successfullyDeletedComment","failedDeleteComment","username","password","credentialError","pendingImages","isNextPageLoading","commentId","onFinish","user","pass","successfullyLoggedIn","failedToLogIn","statusCode","getCookie","setLocalStorage","imageId","isDeletingImage","successfullyDeletedImage","failedDeleteImage","accepted","respondingToImage","successfullyRespondedToImage","failedToRespondToImage","findIndex","img","months","DateUtilities","date","moment","format","monthNumber","SidewalkCommentComponent","_handleDelete","onDelete","details","Card_default","formatDateForDisplay","LoaderComponent","CircularProgress_default","ConfirmationModal","_cancel","onCancel","_confirm","onConfirm","classes","Modal_default","onClose","paper","Modal","Header","Title","Footer","disabledConfirm","withStyles","theme","backgroundColor","palette","background","boxShadow","shadows","padding","spacing","unit","margin","position","top","transform","CommentDeletionModal","deleteComment","success","LoaderComponent_LoaderComponent","misc_components_ConfirmationModal","renderModalBody","COMMENTS_PER_PAGE","COMMENT_ERROR_STATE","COMMENT_PROFANITY_MESSAGE","EMPTY_COMMENT_MESSAGE","PHONE_REGEX","SECONDARY_PHONE_REGEX","Filter","replaceRegex","placeHolder","addWords","CommentsListComponent","_validateCommentState","match","message","_performDetailedCommentValidation","swearsList","words","swear","includes","toLowerCase","isProfane","_onCommentBlur","validation","enteredComment","commentValidation","_handleChange","_handleCheck","deleteLocalStorage","getLocalStorage","SidewalkActions","suspendedSidewalkComment","commentSuspendThirty","_handleSubmit","validateComment","uploadComment","setCookie","_openConfirmationModal","selectedComment","modalOpened","_closeConfirmationModal","deleted","removeLoadedComment","_isRowLoaded","_ref","Boolean","_loadMoreRows","isLoadingComments","loadComments","_getCommentsOnPage","_visitPreviousPage","currentPage","_visitNextPage","SidewalkCommentComponent_SidewalkCommentComponent","Alert","validationState","onBlur","Feedback","renderCurrentCommentsPage","CommentDeletionModal_CommentDeletionModal","getFile","file","Promise","resolve","reject","reader","FileReader","onerror","abort","onload","readAsDataURL","ImageSelectorComponent","readOnly","fileName","fileInput","click","accept","onSelect","ref","ImageUploadModal","_selectImageToUpload","files","size","loadingSelectedImage","selectedImageSize","selectedImage","selectedFileName","_shouldDisplaySizeWarning","_canUpload","_confirmUpload","floor","ImageSelectorComponent_ImageSelectorComponent","alt","src","UploadSidewalkImageComponent","PreviewSidewalkImagesComponent","imageCount","SidewalkImageDetailsComponent","_viewImages","onOpenImages","_openImageModal","_closeImageModal","uploadedFile","uploadSidewalkImage","PreviewSidewalkImagesComponent_PreviewSidewalkImagesComponent","previewImage","UploadSidewalkImageComponent_UploadSidewalkImageComponent","images_ImageUploadModal","PedestrianDataComponent","Paper_default","root","Table_default","TableHead_default","TableRow_default","TableCell_default","tableCell","numeric","TableBody_default","activities","component","scope","distributionPercent","overflowX","fontSize","fontWeight","typography","fontWeightRegular","fontFamily","getRatingDescription","rating","SidewalkRatingsModal","changeAccessibility","accessibilityValue","ChangeConnectivity","connectivityValue","changeComfort","comfortValue","changeSafety","safetyValue","changeSecurity","securityValue","_handleSubmitRating","uploadRatings","_submitStatus","tooltipDescription","tooltip","Tooltip","OverlayTrigger","placement","overlay","Slider_default","slider","min","max","step","paddingLeft","renderSlider","Dialog_default","DialogContent_default","renderBody","DialogActions_default","heading","pxToRem","SidewalkDetailsView","getCSVData","downloadSidewalkCSV","_handleClose","_handleKeyDown","_openRatingsModal","ratingsModalOpen","suspendedSidewalk","rateSuspendThirty","_closeRatingsModal","postedRating","getSidewalkRatings","updateRatings","renderRatingsAmount","totalRatings","stores","selfRef","createRef","prevProps","loadSidewalkDetails","header","expanded","ExpansionPanel_default","defaultExpanded","ExpansionPanelSummary_default","expandIcon","ExpandMore_default","data-sidewalk-header","Typography_default","ExpansionPanelDetails_default","velocityText","imageSection","averageVelocity","react_csv","SidewalkImageDetailsComponent_SidewalkImageDetailsComponent","sidewalk_SidewalkRatingsModal","_formatRating","CommentsListComponent_CommentsListComponent","mobilityTypeDistribution","sidewalk_PedestrianDataComponent","renderExpansionPanel","renderSummaryDetails","renderUploadImageComponent","renderRatings","renderComments","renderPedestrianData","tabIndex","onKeyDown","Drawer_default","anchor","variant","ModalProps","onBackdropClick","renderDrawerDetails","ImageDeletionModal","deleteImage","PAGE_SIZE","InfiniteImageGalleryCarousel","getCurrentIndex","galleryRef","current","_onSelectionChanged","newIndex","hasNextPage","loadedImages","loadMoreData","_onImageClicked","slideToIndex","_renderCustomControls","renderAboveImage","item","original","thumbnail","sizes","originalClass","image_gallery_default","items","infinite","lazyLoad","showPlayButton","renderCustomControls","onSlide","thumbnailPosition","showFullscreenButton","noDrawer","renderCarousel","SlideProps","unmountOnExit","SidewalkUploadedImagesGallery","_loadMoreImages","loadUploadedImages","_onDeleteImageClicked","_onModalClosed","removeLoadedImage","_renderDeleteButton","deleteIcon","Grid_default","Tooltip_default","Avatar_default","Delete_default","justify","direction","flexGrow","InfiniteImageGalleryCarousel_InfiniteImageGalleryCarousel","ImageDeletionModal_ImageDeletionModal","BaseAlertComponent","Snackbar_default","anchorOrigin","vertical","horizontal","autoHideDuration","SnackbarContent_default","alertContentClassName","aria-describedby","icon","action","hideClose","IconButton_default","aria-label","ErrorAlertComponent","BaseAlertComponent_BaseAlertComponent","Error_default","UploadedImageErrorComponent","dismissImageErrorMessage","ErrorAlertComponent_ErrorAlertComponent","SuccessAlertComponent","CheckCircle_default","UploadedImageSuccessComponent","dismissImageSuccessMessage","SuccessAlertComponent_SuccessAlertComponent","CommentDeleteSuccessComponent","dismissCommentSuccessMessage","CommentDeleteErrorComponent","dismissCommentErrorMessage","ImageDeleteErrorComponent","ImageDeleteSuccessComponent","CommentPostSuccessComponent","CommentPostErrorComponent","PostRatingSuccessComonent","dismissRatingsSuccessMessage","PostRatingErrorComponent","dismissRatingsFailureMessage","PostRatingSameSidewalk","dismissSuspendSidewalk","PostRatingThirtyComponent","dismissRateSuspendThirty","PostCommentingSameSidewalk","dismissSuspendSidewalkComment","PostCommentingThirtySidewalk","dismissCommentSuspendThirty","AlertsContainer","UploadedImageErrorComponent_UploadedImageErrorComponent","UploadedImageSuccessComponent_UploadedImageSuccessComponent","CommentDeleteSuccessComponent_CommentDeleteSuccessComponent","CommentDeleteErrorComponent_CommentDeleteErrorComponent","ImageDeleteErrorComponent_ImageDeleteErrorComponent","ImageDeleteSuccessComponent_ImageDeleteSuccessComponent","CommentPostErrorComponent_CommentPostErrorComponent","CommentPostSuccessComponent_CommentPostSuccessComponent","PostRatingSuccessComponent_PostRatingSuccessComonent","PostRatingErrorComponent_PostRatingErrorComponent","PostRatingSameSidewalk_PostRatingSameSidewalk","PostRatingThirtyComponent_PostRatingThirtyComponent","PostCommentingSameSidewalk_PostCommentingSameSidewalk","PostCommentingThirtyComponent_PostCommentingThirtySidewalk","MapDashboard","MapActions","setDrawerOpened","viewingImages","_closeImages","_updateRatings","updateSidewalkRatings","_onCloseDrawer","loadAllSidewalks","SummaryMapView_SummaryMapView","sidewalk_SidewalkDetailsView","SidewalkUploadedImagesGallery_SidewalkUploadedImagesGallery","AlertsContainer_AlertsContainer","AboutPageView","renderCategory","PendingImagesGallery","AdminActions","getUnapprovedImages","_onAcceptImage","handlePendingImages","_onRejectImage","_renderResponseButtons","_dismissNotifications","dismissImageApprovalNotification","dismissImageRejectionNotification","AdminDrawerImageGallery","history","showAdminImages","PendingImagesGallery_PendingImagesGallery","styles","menuButton","marginLeft","marginRight","button","&:hover","&:focus","titleButton","NavbarComponent","_logout","logoutAdmin","deleteCookie","AppBar_default","Toolbar_default","Link","to","Button_default","AdminLogin","_handleUserChange","enteredName","_handlePassChange","enteredPassword","_validateCredentials","attempts","isNaN","checkCredentials","md5","dismissLoginSuccess","dismissLoginError","data-admin-login","CardContent_default","autoFocus","SummaryStatisticsStore","isLoading","all","contributionsByMonth","sort","b","aSplit","monthYear","aMonth","aYear","bSplit","bMonth","bYear","allSidewalkArray","sidewalkSummary","csvFormatted","SummaryStatisticsView","_onChangeTab","selectedTab","_selectTextDescription","textDescription","_selectNumericDescription","loadSummaryStatistics","xs","data-contributions-value","contribution","month","year","amount","contributions","lib","pagination","keyField","dataField","dataSort","dataFormat","getMonthName","labels","datasets","label","es","display","scales","yAxes","gridLines","data-summary-contributions","renderCard","totalImagesUploaded","renderContributionsByDate","renderContributionsChart","Radio_default","checked","formatFunc","cell","toFixed","renderFormatSelection","sizePerPage","renderContributions","renderSidewalkDetails","data-summary-stats","Tabs_default","indicatorColor","textColor","centered","Tab_default","renderSelectedTab","App","misc_components_NavbarComponent","Switch","Route","path","AdminPanelView","location","hostname","createMuiTheme","primary","purple","secondary","main","useNextVariants","ReactDOM","render","BrowserRouter","core_styles","src_App","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.401bcd71.chunk.js","sourcesContent":["import Reflux from \"reflux\";\r\n\r\nconst Actions = Reflux.createActions([\r\n\t\"loadAllSidewalks\",\r\n\t\"loadMapDetails\",\r\n\t\"setDrawerOpened\",\r\n\t\"addFilter\",\r\n\t\"clearFilters\",\r\n\t\"filterMap\",\r\n\t\"updateSidewalkRatings\",\r\n\t\"selectSidewalk\",\r\n\t\"removeFilter\"\r\n]);\r\n\r\nexport default Actions;","export const esriURL = { \r\n    url: \"https://js.arcgis.com/4.9\"\r\n};\r\n\r\nexport const layerURL = \"https://services9.arcgis.com/8ccGcFm2KpUhl0DB/arcgis/rest/services/edm_network_walkability/FeatureServer\";\r\nexport const downtownLongitude = -113.4990;\r\nexport const downtownLatitude = 53.5405;\r\n\r\nexport const sidewalkColorMapRenderer = {\r\n\ttype: \"unique-value\",  // autocasts as new UniqueValueRenderer()\r\n\tfield: \"AvgOverall\",\r\n\tdefaultSymbol: { type: \"simple-fill\" },  // autocasts as new SimpleFillSymbol()\r\n\tuniqueValueInfos: [\r\n\r\n\t// this is to cover rounding issues\r\n\t{\r\n\t\tvalue: 5,\r\n\t\tsymbol: {\r\n\t\t\ttype: \"simple-line\",  // autocasts as new SimpleLineSymbol()\r\n\t\t\twidth: 4,\r\n\t\t\tcolor: \"#00A300\",\r\n\t\t\tstyle: \"solid\"\r\n\t\t}\r\n\t}, {\r\n\t\tvalue: 4,\r\n\t\tsymbol: {\r\n\t\t\ttype: \"simple-line\",  // autocasts as new SimpleLineSymbol()\r\n\t\t\twidth: 4,\r\n\t\t\tcolor: \"#00A392\",\r\n\t\t\tstyle: \"solid\"\r\n\t\t}\r\n\t}, {\r\n\t\tvalue: 3,\r\n\t\tsymbol: {\r\n\t\t\ttype: \"simple-line\",  // autocasts as new SimpleLineSymbol()\r\n\t\t\twidth: 4,\r\n\t\t\tcolor: \"#FF7A00\",\r\n\t\t\tstyle: \"solid\"\r\n\t\t}\r\n\t}, {\r\n\t\tvalue: 2,\r\n\t\tsymbol: {\r\n\t\t\ttype: \"simple-line\",  // autocasts as new SimpleLineSymbol()\r\n\t\t\twidth: 4,\r\n\t\t\tcolor: '#f9a602',\r\n\t\t\tstyle: \"solid\"\r\n\t\t}\r\n\t}, {\r\n\t\tvalue: 1,\r\n\t\tsymbol: {\r\n\t\t\ttype: \"simple-line\",  // autocasts as new SimpleLineSymbol()\r\n\t\t\twidth: 4,\r\n\t\t\tcolor: \"#FF0000\",\r\n\t\t\tstyle: \"solid\"\r\n\t\t}\r\n\t}, {\r\n\t\tvalue: 0,\r\n\t\tsymbol: {\r\n\t\t\ttype: \"simple-line\",  // autocasts as new SimpleLineSymbol()\r\n\t\t\twidth: 4,\r\n\t\t\tcolor: \"#D2D3D1\",\r\n\t\t\tstyle: \"solid\"\r\n\t\t}\r\n\t}, {\r\n\t\tvalue: \"\",\r\n\t\tsymbol: {\r\n\t\t\ttype: \"simple-line\",  // autocasts as new SimpleLineSymbol()\r\n\t\t\tcolor: \"#D2D3D1\",\r\n\t\t\twidth: 4,\r\n\t\t\tstyle: \"solid\"\r\n\t\t}\r\n\t  }],\r\n\t  highlightOptions: {\r\n\t\tcolor: [255, 241, 58],\r\n\t\tfillOpacity: 0.4\r\n\t  }\r\n\t};\r\n","export const DATABASE_BASE_URL = \"https://199.116.235.159:8443\",\r\n\tMAX_UPLOAD_SIZE = 3145728;\r\n","import rp from \"request-promise\";\r\nimport {DATABASE_BASE_URL} from \"../constants/DatabaseConstants\";\r\n\r\n/**\r\n * Gets the URL to send an HTTP request to\r\n * @param {String} endpoint - the endpoint to send the request to on the server (everything after the /api/ part of the URI)\r\n * @return the URL to send an HTTP request to\r\n */\r\nconst makeRequestURL = (endpoint) => {\r\n\treturn `${DATABASE_BASE_URL}/api/${endpoint}/`;\r\n};\r\n\r\nexport default class RestUtil {\r\n\r\n\t/**\r\n\t * Sends an HTTP POST request to the specified endpoint\r\n\t * @param {String} endpoint - the endpoint in the database to send the request to\r\n\t * @param {Object} body - the payload to send as part of the request\r\n\t * @param {Object?} optionOverrides - an object that defines overrides to the options sent with the request\r\n\t * @return {Promise} - a promise that resolves when the request is complete with the response as it's parameter\r\n\t */\r\n\tstatic sendPostRequest(endpoint, body, optionOverrides = {}) {\r\n\t\tconst options = Object.assign({\r\n\t\t\turi: makeRequestURL(endpoint),\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\"\r\n\t\t\t},\r\n\t\t\tjson: true,\r\n\t\t\tmethod: \"POST\",\r\n\t\t\tbody: body\r\n\t\t}, optionOverrides);\r\n\t\treturn rp.post(options);\r\n\t}\r\n\r\n\t/**\r\n\t * Sends an HTTP GET request to the specified endpoint\r\n\t * @param {String} endpoint - the endpoint in the database to send the request to\r\n\t * @param {Object?} query - an optional parameter defining any query strings include in the request URL\r\n\t * @param {Object?} optionOverrides - an object that defines overrides to the options sent with the request\r\n\t * @return {Promise} - a promise that resolves when the request is complete with the response as it's parameter\r\n\t */\r\n\tstatic sendGetRequest(endpoint, query = {}, optionOverrides = {}) {\r\n\t\tconst options = Object.assign({\r\n\t\t\turi: makeRequestURL(endpoint),\r\n\t\t\tjson: true,\r\n\t\t\tqs: query\r\n\t\t}, optionOverrides);\r\n\t\treturn rp.get(options);\r\n\t}\r\n}","import Reflux from \"reflux\";\r\nimport esriLoader from \"esri-loader\";\r\nimport Actions from \"./MapActions\";\r\nimport {esriURL, layerURL, downtownLongitude, downtownLatitude, sidewalkColorMapRenderer} from \"../constants/ArcGISConstants\";\r\nimport RestUtil from \"../util/RestUtil\";\r\n\r\nexport default class MapStore extends Reflux.Store {\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n\t\t\tsidewalks: [],\r\n\t\t\tsidewalkSelected: false,\r\n\t\t\tlongitude: downtownLongitude,\r\n\t\t\tlatitude: downtownLatitude,\r\n\t\t\tmapFilters: [],\r\n\t\t\tsearchVisible: false\r\n\t\t\t\r\n\t\t};\r\n\t\tthis.listenables = Actions;\r\n\r\n\t\tif (process.env.NODE_ENV === \"development\"){\r\n\t\t\twindow.DEV_MAP_STORE = this;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Displays the selected sidewalk\r\n\t * @param {Object} sidewalk - details about the sidewalk\r\n\t * @param {number} latitude - the latitude of the sidewalk's center position\r\n\t * @param {number} longitude - the longitude of the sidewalk's center position\r\n\t */\r\n\tviewSidewalkDetails(sidewalk, latitude, longitude) {\r\n\t\tif (!this.state.view) {\r\n\t\t\tconsole.error(\"The view was not loaded\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.state.view.goTo({\r\n\t\t\tcenter: [longitude, latitude],\r\n\t\t\tanimate: true,\r\n\t\t\tduration: 200,\r\n\t\t\teasing: \"easy-in\"\r\n\t\t});\r\n\t\tthis.setState({\r\n\t\t\tlongitude: longitude,\r\n\t\t\tlatitude: latitude,\r\n\t\t\tsidewalkSelected: true,\r\n\t\t\tselectedSidewalkDetails: sidewalk\r\n\t\t});\r\n\t}\r\n\r\n\tonLoadAllSidewalks() {\r\n\t\tRestUtil.sendGetRequest(\"sidewalk\").then((res) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tsidewalks: res\r\n\t\t\t});\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\t\r\n\tonSetDrawerOpened(open) {\r\n\t\tthis.setState({\r\n\t\t\tsidewalkSelected: open\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Calls esriLoader which helps the react-app to communicate with the ArcGIS API for javascript\r\n\t */\r\n    onLoadMapDetails() {\r\n\t\tesriLoader.loadModules(['esri/Map', 'esri/views/MapView','esri/widgets/Search', \"esri/widgets/BasemapToggle\"], esriURL).then((data) => {\r\n\t\t\tconst Map = data[0],\r\n\t\t\t\tMapView = data[1];\r\n\t\t\t\r\n\t\t\tconst Search = data[2];\r\n\t\t\tconst BasemapToggle = data[3];\r\n\r\n\t\t\tconst map = new Map({\r\n\t\t\t\tbasemap: \"dark-gray-vector\"\r\n\t\t\t});\r\n\r\n\t\t\tconst view = new MapView({\r\n\t\t\t\tmap: map,\r\n\t\t\t\tcontainer: \"mapContainer\",\r\n\t\t\t\tcenter: [this.state.longitude, this.state.latitude],\r\n\t\t\t\tzoom: 15\r\n\t\t\t});\r\n\r\n\t\t\tconst toggle = new BasemapToggle({\r\n\t\t\t\tview: view, // view that provides access to the map's 'topo' basemap\r\n\t\t\t\tnextBasemap: \"osm\" // allows for toggling to the 'hybrid' basemap\r\n\t\t\t  });\r\n\t  \r\n\t\t\tview.ui.add(toggle, \"\");\r\n\r\n\t\t\tconst search = new Search({\r\n\t\t\t\tview: view\r\n\t\t\t});\r\n\r\n\t\t\tview.ui.add(search, \"top-right\");\r\n\t\t\tthis.setState({\r\n\t\t\t\tmap,\r\n\t\t\t\tview,\r\n\t\t\t\tsearch\r\n\t\t\t});\r\n\r\n\t\t\treturn esriLoader.loadModules([\"esri/layers/FeatureLayer\", \"esri/geometry/Circle\", \"esri/widgets/Legend\", \"esri/widgets/Expand\"], esriURL);\r\n\t\t}).then((data) => {\r\n\t\t\t\r\n\t\t\tconst FeatureLayer = data[0],\r\n\t\t\t\tCircle = data[1],\r\n\t\t\t\tLegend = data[2],\r\n\t\t\t\tExpand = data[3],\r\n\t\t\t\tview = this.state.view;\t\r\n\t\t\t\r\n\t\t\tconst featureLayer = new FeatureLayer({\r\n\t\t\t\turl: layerURL,\r\n\t\t\t\trenderer: sidewalkColorMapRenderer,\r\n\t\t\t\tdefinitionExpression: \"\"\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tthis.setState({\r\n\t\t\t\tsidewalkColorMapRenderer,\r\n\t\t\t\tfeatureLayer\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// set the feature layer in window so we can access this when rating a sidewalk\r\n\t\t\twindow.featureLayer = featureLayer;\r\n\t \r\n\t\t\tview.when(() => {\r\n\t\t\t\t// get the first layer in the collection of operational layers in the WebMap\r\n\t\t\t\t// when the resources in the MapView have loaded.\r\n\t\t\t\tconst legend = new Legend({\r\n\t\t\t\t  view: view,\r\n\t\t\t\t  layerInfos: [{\r\n\t\t\t\t\tlayer: featureLayer,\r\n\t\t\t\t\ttitle: \"Sidewalk Ratings\"\r\n\t\t\t\t  }]\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t/*Functionality to create legend object */\r\n\t\t\t\tconst expandLegend = new Expand({\r\n\t\t\t\t\tview: view,\r\n\t\t\t\t\tcontent: new Legend({\r\n\t\t\t\t\t  view: view,\r\n\t\t\t\t\t  layerInfos: [{\r\n\t\t\t\t\t\tlayer: featureLayer,\r\n\t\t\t\t\t\ttitle: \"Sidewalk Ratings\"\r\n\t\t\t\t\t  }]\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\r\n\t\t\t\tupdateView(view.widthBreakpoint === \"xsmall\");\r\n\t\t\t\t\r\n\t\t\t\t// Breakpoints\r\n\t\t\t\tview.watch(\"widthBreakpoint\", function(breakpoint) {\r\n\t\t\t\t\tswitch (breakpoint) {\r\n\t\t\t\t\t  case \"xsmall\":\r\n\t\t\t\t\t\tupdateView(true);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t  case \"small\":\r\n\t\t\t\t\t  \tupdateView(true);\r\n\t\t\t\t\t  \tbreak;\r\n\t\t\t\t\t  case \"medium\":\r\n\t\t\t\t\t  case \"large\":\r\n\t\t\t\t\t  case \"xlarge\":\r\n\t\t\t\t\t\tupdateView(false);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t  default:\r\n\t\t\t\t\t}\r\n\t\t\t\t  });\r\n\r\n\t\t\t\t  function updateView(isMobile) {\r\n\t\t\t\t\tsetLegendMobile(isMobile);\r\n\t\t\t\t  }\r\n\r\n\t\t\t\t  function setLegendMobile(isMobile) {\r\n\t\t\t\t\tconst toAdd = isMobile ? expandLegend : legend;\r\n\t\t\t\t\tconst toRemove = isMobile ? legend : expandLegend;\r\n\t\t\t\r\n\t\t\t\t\tview.ui.remove(toRemove);\r\n\t\t\t\t\tview.ui.add(toAdd, \"bottom-left\");\r\n\t\t\t\t\tview.ui.add(\"filterGUIMinimized\", \"bottom-left\");\r\n\t\t\t\t\tview.ui.add(\"filterGUI\", \"bottom-left\");\r\n\t\t\t\t  }\r\n\t\t\t});\r\n\r\n\t\t\tconst pxRadius = 5;\r\n\t\t\tthis.state.map.add(featureLayer);\r\n\r\n\t\t\tthis.state.view.on(\"click\", (event) => {\r\n\t\t\t\tlet sidewalkGPSAdress = '';\r\n\t\t\t\tconst pxToMeters = view.extent.width / view.width;\r\n\r\n\t\t\t\tfeatureLayer.popupEnabled = false;\r\n\t\t\t\tview.popup.dockEnabled = true;\r\n\t\t\t\tview.popup.visible = false;\r\n\t\t\t\tview.popup.dockOptions = {\r\n\t\t\t\t\tbuttonEnabled: false\r\n\t\t\t\t}\r\n\t\t\t\tfeatureLayer.popupTemplate = {\r\n\t\t\t\t\ttitle: \"Street ID: {osm_id}\",\r\n\t\t\t\t\tcontent: \"Average Rating: {AvgOverall}\"\r\n\t\t\t\t}  \r\n\t\t\t\t\t\t\r\n\t\t\t\tconst c = new Circle({\r\n\t\t\t\t\tcenter: event.mapPoint,\r\n\t\t\t\t\tradius: pxRadius * pxToMeters // meters by default\r\n\t\t\t\t});\r\n\r\n\t\t\t\t/*Reverse geocoding search to convert GPS points to address name*/\r\n\t\t\t\tthis.state.search.clear();\r\n\t\t\t\tif (this.state.search.activeSource) {\r\n\t\t\t\t\tthis.state.search.activeSource.locator.locationToAddress(event.mapPoint).then((response) => {\r\n\t\t\t\t\t\tsidewalkGPSAdress = response.address.split(',')[0];\r\n\t\t\t\t\t  }, (err) => {\r\n\t\t\t\t\t\tconsole.error(\"Error reverse GPS to address\")\r\n\t\t\t\t\t  });\r\n\t\t\t\t\t}\r\n\t\t\t\t/*Creates a query that querys for sidewalks with a certain distance of the mouse click*/\r\n\t\t\t\tconst q = featureLayer.createQuery();\r\n\t\t\t\tq.geometry = c;\r\n\t\t\t\t\r\n\t\t\t\tfeatureLayer.queryFeatures(q).then((results) => {\r\n\t\t\t\t\tif (results.features.length !== 0){\r\n\t\t\t\t\t\tconst sidewalkID = parseInt(results.features[0].attributes.osm_id)\r\n\t\t\t\t\t\tconst sidewalk = this.state.sidewalks.find((s) => s.id === sidewalkID);\r\n\t\t\t\t\t\tsidewalk.address = sidewalkGPSAdress;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (!sidewalk) {\r\n\t\t\t\t\t\t\tconsole.error(\"No sidewalk with a matching ID was found\");\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.viewSidewalkDetails(sidewalk, event.mapPoint.latitude, event.mapPoint.longitude);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t/**Adds selected filter options into an array newMapFilters \r\n\t* @param {String} strTrait - Trait selected to filter such as accessability for comfort\r\n\t* @param {String} strEquality - Equality selected such as <, >, <=, =, >=\r\n\t* @param {String} strNumberSelect - Selects the number the trait must be to filter\r\n\t* @param {Object} dbTrait - used for deleting a single filter and not all\r\n\t*/\r\n\tonAddFilter(strTrait, strEquality, strNumberSelect, dbTrait) {\r\n\t\tconst newMapFilters = this.state.mapFilters;\r\n\t\tnewMapFilters.push({\r\n\t\t\ttrait: strTrait,\r\n\t\t\toperator: strEquality,\r\n\t\t\tvalue: strNumberSelect,\r\n\t\t\tdbTrait: dbTrait\r\n\t\t});\r\n\r\n\t\tthis.setState({\r\n\t\t\tmapFilters: newMapFilters\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * \r\n\t * @param {int} index - Removes a single filter given the number\r\n\t */\r\n\tonRemoveFilter(index) {\r\n\t\tconst newMapFilters = this.state.mapFilters;\r\n\t\tnewMapFilters.splice(index, 1);\r\n\t\tthis.setState({\r\n\t\t\tmapFilters: newMapFilters\r\n\t\t});\r\n\t\tthis.onFilterMap();\r\n\t}\r\n\t\r\n\t/**\r\n\t * clears all filters currently applied to map\r\n\t */\r\n\tonClearFilters(){\r\n\t\tthis.state.featureLayer.definitionExpression = \"\";\r\n\t\tthis.setState({\r\n\t\t\tmapFilters: []\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Applies filter to map converting the array of strings into an SQL query\r\n\t */\r\n\tonFilterMap() {\r\n\t\tthis.state.featureLayer.definitionExpression = this.state.mapFilters.map((filter) => {\r\n\t\t\treturn `${filter.dbTrait} ${filter.operator} ${filter.value}`;\r\n\t\t}).join(\" and \");\r\n\t}\r\n\t\r\n\t/**\r\n\t * Updates the ratings for the currently selected sidewalk\r\n\t * @param {Object} sidewalk - the current sidewalk\r\n\t */\r\n\tonUpdateSidewalkRatings(sidewalk) {\r\n\t\tconst updatedSidewalks = this.state.sidewalks.slice();\r\n\t\tconst selectedSidewalk = updatedSidewalks.find((sidewalk) => {\r\n\t\t\treturn sidewalk.id === this.state.selectedSidewalkDetails.id;\r\n\t\t});\r\n\t\tif (!selectedSidewalk) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tselectedSidewalk.accessibility = sidewalk.accessibility;\r\n\t\tselectedSidewalk.overallRating = sidewalk.overallRating;\r\n\t\tselectedSidewalk.comfort = sidewalk.comfort;\r\n\t\tselectedSidewalk.connectivity = sidewalk.connectivity;\r\n\t\tselectedSidewalk.physicalSafety = sidewalk.physicalSafety;\r\n\t\tselectedSidewalk.senseOfSecurity = sidewalk.senseOfSecurity;\r\n\t\tthis.setState({\r\n\t\t\tsidewalks: updatedSidewalks\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Selects the specified sidewalk and displays details about it, when the user searches for the sidewalk\r\n\t */\r\n\tonSelectSidewalk(sidewalk) {\r\n\t\tif (!this.state.featureLayer) {\r\n\t\t\tthis.viewSidewalkDetails(sidewalk, this.state.latitude, this.state.longitude);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst q = this.state.featureLayer.createQuery();\r\n\t\tthis.state.featureLayer.queryFeatures(q).then((results) => {\r\n\t\t\tconst result = results.features.find((feature) => parseInt(feature.attributes.osm_id) === sidewalk.id);\r\n\t\t\tif (result) {\r\n\t\t\t\tthis.viewSidewalkDetails(sidewalk, result.geometry.extent.center.latitude, result.geometry.extent.center.longitude);\r\n\t\t\t} else {\r\n\t\t\t\tthis.viewSidewalkDetails(sidewalk, this.state.latitude, this.state.longitude);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}","import React from \"react\";\r\nimport { Component } from 'reflux';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nimport Actions from \"./MapActions\";\r\nimport Store from \"./MapStore\";\r\nimport {Button, FormGroup, ControlLabel, FormControl} from \"react-bootstrap\";\r\n\r\nconst TRAITS = [\"Overall\", \"Accessibility\", \"Comfort\", \"Connectivity\", \"Physical Safety\", \"Sense of Security\"];\r\nconst OPERATORS = [\">\", \"<\", \">=\", \"<=\", \"=\"];\r\nconst VALUES = [1, 2, 3, 4, 5];\r\nconst TRAIT_MAP = {\r\n\t\"Overall\": \"AvgOverall\",\r\n\t\"Sense of Security\": \"AvgSecurity\",\r\n\t\"Accessibility\": \"AvgAccessibility\",\r\n\t\"Connectivity\": \"AvgConnectivity\",\r\n\t\"Comfort\": \"AvgComfort\",\r\n\t\"Physical Safety\": \"AvgSafety\"\r\n};\r\n\r\n/**\r\n * Renders the modal allowing users to filter which sidewalks they want to see\r\n */\r\nexport default class MapFilterModal extends Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t\tthis.state = {\r\n\t\t\tselectedTrait: TRAITS[0],\r\n\t\t\tselectedOperator: OPERATORS[0],\r\n\t\t\tselectedValue: VALUES[0],\r\n\t\t\tisExpanded: false\r\n\t\t};\r\n\t}\r\n\t/*Calls addFilter in map MapStore */\r\n\thandleAddFilterEvent = () => {\r\n\t\tActions.addFilter(this.state.selectedTrait, this.state.selectedOperator, this.state.selectedValue, TRAIT_MAP[this.state.selectedTrait]);\r\n\t}\r\n\t/*Calls handleClearFilterEvent in map MapStore */\r\n\thandleClearFilterEvent = () => {\r\n\t\tActions.clearFilters();\r\n\t}\r\n\t\r\n\t_handleTraitChange = (e) => {\r\n\t\tthis.setState({\r\n\t\t\tselectedTrait: e.target.value\r\n\t\t});\r\n\t};\r\n\t\r\n\t_handleOperatorChange = (e) => {\r\n\t\tthis.setState({\r\n\t\t\tselectedOperator: e.target.value\r\n\t\t});\r\n\t};\r\n\t\r\n\t_handleValueChange = (e) => {\r\n\t\tthis.setState({\r\n\t\t\tselectedValue: e.target.value\r\n\t\t});\r\n\t};\r\n\t\r\n\t_expand = () => {\r\n\t\tthis.setState({\r\n\t\t\tisExpanded: true\r\n\t\t});\r\n\t};\r\n\t\r\n\t_minimize = () => {\r\n\t\tthis.setState({\r\n\t\t\tisExpanded: false\r\n\t\t});\r\n\t};\r\n\t\r\n\trenderTable() {\r\n\t\treturn (\r\n\t\t\t<table className=\"table table-bordered table-responsive-md table-striped text-center filterTable\">\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th>Trait</th>\r\n\t\t\t\t\t\t<th>Operator</th>\r\n\t\t\t\t\t\t<th>Value</th>\r\n\t\t\t\t\t\t<th></th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.state.mapFilters.map((filter, i) => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<tr key={i}>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t{filter.trait}\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t{filter.operator}\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t{filter.value}\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\t<CloseIcon className=\"closeButton\" onClick={() => Actions.removeFilter(i)} />\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t);\r\n\t}\r\n\t\r\n\t_getModalStyle = () => {\r\n\t\treturn this.state.isExpanded ? undefined : {opacity: 0};\r\n\t};\r\n\t\r\n\t_getMinimizedModalStyle = () => {\r\n\t\treturn !this.state.isExpanded ? undefined : {opacity: 0};\r\n\t};\r\n\t/*Adds filter to table to display currently selected filters */\r\n\trenderSelect(name, values, selected, onChange) {\r\n\t\treturn (\r\n\t\t\t<div className=\"filterSelectGroup\">\r\n\t\t\t\t<FormGroup controlId={`select${name}`}>\r\n\t\t\t\t  <ControlLabel>{name}</ControlLabel>\r\n\t\t\t\t  <FormControl componentClass=\"select\" placeholder=\"select\" onChange={onChange}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalues.map((trait) => <option value={trait}>{trait}</option>)\r\n\t\t\t\t\t}\r\n\t\t\t\t  </FormControl>\r\n\t\t\t\t</FormGroup>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*Displays model overtop of map*/\r\n\trenderModalContent() {\r\n\t\tif (this.state.isExpanded) {\r\n\t\t\treturn (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className=\"filtersHeader\">\r\n\t\t\t\t\t\t<h4 className=\"filterTitle\">Filters</h4>\r\n\t\t\t\t\t\t<CloseIcon className=\"closeFilters floatRight\" onClick={this._minimize} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"filterWrapper\">\r\n\t\t\t\t\t\t{this.renderSelect(\"Trait\", TRAITS, this.state.selectedTrait, this._handleTraitChange)}\r\n\t\t\t\t\t\t{this.renderSelect(\"Operator\", OPERATORS, this.state.selectedOperator, this._handleOperatorChange)}\r\n\t\t\t\t\t\t{this.renderSelect(\"Value\", VALUES, this.state.selectedValue, this._handleValueChange)}\r\n\t\t\t\t\t\t<Button className=\"addFilter\" bsStyle=\"primary\" bsSize=\"sm\" onClick={this.handleAddFilterEvent}>Add</Button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{this.renderTable()}\r\n\t\t\t\t\t<div className=\"btn-group floatRight\">\r\n\t\t\t\t\t\t<Button bsStyle=\"danger\" bsSize=\"sm\" onClick={this.handleClearFilterEvent} disabled={this.state.mapFilters.length === 0}>Clear</Button>\r\n\t\t\t\t\t\t<Button className=\"applyButton\" bsStyle=\"primary\" bsSize=\"sm\" onClick={Actions.filterMap} disabled={this.state.mapFilters.length === 0}>Apply Filter</Button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"FilterGUIWrapper\">\r\n\t\t\t\t<div id=\"filterGUI\" style={this._getModalStyle()}>\r\n\t\t\t\t\t{this.renderModalContent()}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div id=\"filterGUIMinimized\" style={this._getMinimizedModalStyle()}>\r\n\t\t\t\t\t<Button bsStyle=\"primary\" onClick={this._expand}>Filters</Button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\n\r\nimport Actions from \"./MapActions\";\r\nimport MapFilterModal from \"./MapFilterModal.jsx\";\r\n\r\nexport default class SummaryMapView extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n  \tcomponentDidMount() {\r\n\t\tActions.loadMapDetails();\r\n\t}\r\n\t\r\n\t/*Applies filter to map based on what is currently in the filter table.*/\r\n\thandleApplyFilterEvent = () => {\r\n\t\tActions.filterMap()\r\n\t}\r\n\t/*Pulls strings from each filter selector element and places it into an array for future filter application.*/\r\n\thandleAddFilterEvent = () => {\r\n\t\tlet filterTable = document.getElementById(\"filterTable\");\r\n\t\tlet rateTraitObj = document.getElementById(\"rateTrait\")\r\n\t\tlet equalitySelectorObj = document.getElementById(\"equalitySelector\");\r\n\t\tlet numberSelectorObj = document.getElementById(\"numberSelector\");\r\n\t\tlet strTrait = rateTraitObj.options[rateTraitObj.selectedIndex].text;\r\n\t\tlet strEquality = equalitySelectorObj.options[equalitySelectorObj.selectedIndex].text;\r\n\t\tlet strNumberSelect = numberSelectorObj.options[numberSelectorObj.selectedIndex].text;\r\n\t\tActions.pushArray(strTrait,strEquality,strNumberSelect);\r\n\r\n\t\tlet rowCount = filterTable.rows.length;\r\n\t\tlet row = filterTable.insertRow(rowCount);\r\n\t\tlet colCount = filterTable.rows[0].cells.length;\r\n\r\n\t\tlet cell1 = row.insertCell(0);\r\n\t\tlet cell2 = row.insertCell(0);\r\n\t\tlet cell3 = row.insertCell(0)\r\n\t\t\r\n\t\tcell1.innerHTML = strNumberSelect;\r\n\t\tcell2.innerHTML = strEquality;\r\n\t\tcell3.innerHTML = strTrait;\r\n\t}\r\n\t/*Clears all filters currrently implimented onto the map. This includes the array of filter\r\n\tsand resets map view to have no filters*/\r\n\thandleClearFilterEvent = () => {\r\n\t\tlet filterTable = document.getElementById(\"filterTable\");\r\n\t\tfor(let i = (filterTable.rows.length-1); i > 0; i--){\r\n\t\t\tfilterTable.deleteRow(i);\r\n\t\t}\r\n\t\tActions.clearFilters();\r\n\t}\r\n\r\n\t\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div id=\"main\">\r\n\t\t\t\t<div id=\"mapContainer\" />\r\n\t\t\t\t<MapFilterModal />\r\n\t\t\t\t<div id=\"BasemapToggle\" />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import Reflux from \"reflux\";\r\n\r\nconst Actions = Reflux.createActions([\r\n\t\"uploadSidewalkImage\",\r\n\t\"loadUploadedImages\",\r\n\t\"loadSidewalkDetails\",\r\n\t\"uploadComment\",\r\n\t\"dismissImageErrorMessage\",\r\n\t\"dismissImageSuccessMessage\",\r\n\t\"uploadRatings\",\r\n\t\"removeLoadedComment\",\r\n\t\"removeLoadedImage\",\r\n\t\"dismissCommentSuccessMessage\",\r\n\t\"dismissCommentErrorMessage\",\r\n\t\"loadComments\",\r\n\t\"dismissRatingsSuccessMessage\",\r\n\t\"dismissRatingsFailureMessage\",\r\n\t\"getSidewalkRatings\",\r\n\t\"suspendedSidewalk\",\r\n\t\"rateSuspendThirty\",\r\n\t\"dismissSuspendSidewalk\",\r\n\t\"dismissRateSuspendThirty\",\r\n\t\"downloadSidewalkCSV\",\r\n\t\"suspendedSidewalkComment\",\r\n\t\"dismissSuspendSidewalkComment\",\r\n\t\"commentSuspendThirty\",\r\n\t\"dismissCommentSuspendThirty\"\r\n]);\r\n\r\nexport default Actions;","import Reflux from \"reflux\";\r\n\r\nimport Actions from \"./SidewalkActions\";\r\nimport RestUtil from \"../util/RestUtil\";\r\n\r\n/**\r\n * This store keeps track of the state of components that deal with sidewalks\r\n */\r\nexport default class SidewalkStore extends Reflux.Store {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.state = this._getDefaultSidewalkState();\r\n\t\tthis.listenables = Actions;\r\n\r\n\t\tif (process.env.NODE_ENV === \"development\"){\r\n\t\t\twindow.DEV_SIDEWALK_STORE = this;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the default state of the store before a sidewalk is selected\r\n\t * @return {Object} - the default state of the store before a sidewalk is selected\r\n\t */\r\n\t_getDefaultSidewalkState() {\r\n\t\treturn {\r\n\t\t\tloadedUserImages: [],\r\n\t\t\thasNextImagesPage: true,\r\n\t\t\tcurrentSidewalk: null,\r\n\t\t\tuploadingSidewalkImage: false,\r\n\t\t\tuploadedImageError: false,\r\n\t\t\tuploadingComment: false,\r\n\t\t\tuploadCommentFailed: false,\r\n\t\t\tuploadImageSucceeded: false,\r\n\t\t\tratingStatus: true,\r\n\t\t\tsameSidewalkRatingError: false,\r\n\t\t\tthirtySecondRatingError: false,\r\n\t\t\thasNextCommentsPage: true,\r\n\t\t\tsidewalkHasCSVData: false,\r\n\t\t\tcommentOneSidewalk: false,\r\n\t\t\tthirtyCommentSuspend: false,\r\n\t\t\tisNextImagePageLoading: false\r\n\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Loads data about the specified sidewalk\r\n\t * @param {Object} sidewalk - a basic summary of the sidewalk to load, including it's id and average ratings\r\n\t */\r\n\tonLoadSidewalkDetails(sidewalk) {\r\n\t\tthis.setState(this._getDefaultSidewalkState());\r\n\t\tRestUtil.sendGetRequest(`sidewalk/${sidewalk.id}`).then((data) => {\r\n\t\t\tconst newSidewalk = Object.assign({}, sidewalk, data),\r\n\t\t\t\thasNextCommentsPage = newSidewalk.comments.length === 25;\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrentSidewalk: newSidewalk,\r\n\t\t\t\thasNextImagesPage: newSidewalk.lastImage,\r\n\t\t\t\tloadedUserImages: [newSidewalk.lastImage],\r\n\t\t\t\thasNextCommentsPage: hasNextCommentsPage,\r\n\t\t\t\taddress: sidewalk.address\r\n\t\t\t});\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the user selecting an image to upload to a sidewalk\r\n\t * @param {String} base64Image - the image as a base64 string\r\n\t */\r\n\tonUploadSidewalkImage(base64Image) {\r\n\t\tthis.setState({\r\n\t\t\tuploadingSidewalkImage: true,\r\n\t\t\tuploadedImageError: false,\r\n\t\t\tuploadImageSucceeded: false\r\n\t\t});\r\n\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${this.state.currentSidewalk.id}/image/create`, {\r\n\t\t\timage: base64Image\r\n\t\t}).then(() => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tuploadingSidewalkImage: false,\r\n\t\t\t\tuploadImageSucceeded: true\r\n\t\t\t});\r\n\t\t}).catch((err) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tuploadingSidewalkImage: false,\r\n\t\t\t\tuploadedImageError: true\r\n\t\t\t});\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Loads user uploaded images from the database\r\n\t * @param {number} startIndex - the amount of images to skip before starting to return them\r\n\t * @param {number} stopIndex - the index of the last item to load\r\n\t */\r\n\tonLoadUploadedImages(startIndex, stopIndex, updateStateCallback) {\r\n\t\tthis.setState({\r\n\t\t\tisNextImagePageLoading: true\r\n\t\t});\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${this.state.currentSidewalk.id}/image`, {\r\n\t\t\tstartIndex: startIndex,\r\n\t\t\tendIndex: stopIndex\r\n\t\t}).then((res) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\thasNextImagesPage: res.hasMoreImages,\r\n\t\t\t\tloadedUserImages: this.state.loadedUserImages.slice(0).concat(res.images),\r\n\t\t\t\tisNextImagePageLoading: false\r\n\t\t\t});\r\n\t\t}).catch((err) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisNextImagePageLoading: false\r\n\t\t\t});\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Uploads a comment to the database for the current sidewalk\r\n\t * @param {String} comment - the comment to upload\r\n\t */\r\n\tonUploadComment(comment) {\r\n\t\tthis.setState({\r\n\t\t\tuploadingComment: true,\r\n\t\t\tuploadCommentSucceeded: false,\r\n\t\t\tuploadCommentFailed: false\r\n\t\t});\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${this.state.currentSidewalk.id}/comment/create`, {\r\n\t\t\ttext: comment\r\n\t\t}).then((res) => {\r\n\t\t\tconst currentSidewalkComments = this.state.currentSidewalk.comments.slice();\r\n\t\t\tcurrentSidewalkComments.unshift(res);\r\n\t\t\tthis.setState({\r\n\t\t\t\tuploadingComment: false,\r\n\t\t\t\tuploadCommentSucceeded: true,\r\n\t\t\t\tcurrentSidewalk: Object.assign(this.state.currentSidewalk, { comments: currentSidewalkComments })\r\n\t\t\t});\r\n\t\t}).catch((err) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tuploadingComment: false,\r\n\t\t\t\tuploadCommentFailed: true\r\n\t\t\t});\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\t/**\r\n\t * Displays the message notifying users they can't post more than 3 comments for one sidewalk in a day\r\n\t */\r\n\tonSuspendedSidewalkComment() {\r\n\t\tthis.setState({\r\n\t\t\tcommentOneSidewalk: true\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Dismisses the message notifying users they can't post more than 3 comments for one sidewalk in a day\r\n\t */\r\n\tonDismissSuspendSidewalkComment() {\r\n\t\tthis.setState({\r\n\t\t\tcommentOneSidewalk: false\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Displays the message notifying users they can't post more than 3 comments across all sidewalks within 30 seconds\r\n\t */\r\n\tonCommentSuspendThirty() {\r\n\t\tthis.setState({\r\n\t\t\tthirtyCommentSuspend: true\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Hides the message notifying users they can't post more than 3 comments across all sidewalks within 30 seconds\r\n\t */\r\n\tonDismissCommentSuspendThirty() {\r\n\t\tthis.setState ({\r\n\t\t\tthirtyCommentSuspend: false\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Dismisses the message notifying the user that their comment was successfully posted\r\n\t */\r\n\tonDismissCommentSuccessMessage() {\r\n\t\tthis.setState({\r\n\t\t\tuploadCommentSucceeded: false\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dismisses the message notifying the user that their comment was unable to be posted\r\n\t */\r\n\tonDismissCommentErrorMessage() {\r\n\t\tthis.setState({\r\n\t\t\tuploadCommentFailed: false\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dismisses the message notifying the user that an error happened when uploading an image\r\n\t */\r\n\tonDismissImageErrorMessage() {\r\n\t\tthis.setState({\r\n\t\t\tuploadedImageError: false\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Dismisses the message notifying the user that their image was successfully uploaded\r\n\t */\r\n\tonDismissImageSuccessMessage() {\r\n\t\tthis.setState({\r\n\t\t\tuploadImageSucceeded: false\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Submits the user's ratings of the current sidewalk\r\n\t */\r\n\tonUploadRatings(accessibility, comfort, connectivity, physicalSafety, senseOfSecurity, onSuccess) {\r\n\t\tthis.setState({\r\n\t\t\tisUploadingRatings: true,\r\n\t\t\tsuccessfullyUploadedRatings: false,\r\n\t\t\tfailedUploadingRatings: false\r\n\t\t});\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${this.state.currentSidewalk.id}/rate`, {\r\n\t\t\taccessibility: parseFloat(accessibility),\r\n\t\t\tcomfort: parseFloat(comfort),\r\n\t\t\tconnectivity: parseFloat(connectivity),\r\n\t\t\tsenseOfSecurity: parseFloat(senseOfSecurity),\r\n\t\t\tphysicalSafety: parseFloat(physicalSafety)\r\n\t\t}).then((result) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisUploadingRatings: false,\r\n\t\t\t\tsuccessfullyUploadedRatings: true\r\n\t\t\t});\r\n\t\t\tthis.synchronizeSidewalk()\r\n\t\t\treturn onSuccess();\r\n\t\t}).catch((error) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisUploadingRatings: false,\r\n\t\t\t\tfailedUploadingRatings: true\r\n\t\t\t});\r\n\t\t\tconsole.error(error);\r\n\t\t});\r\n\t}\r\n\r\n\tonSuspendedSidewalk() {\r\n\t\tthis.setState({\r\n\t\t\tsameSidewalkRatingError: true\r\n\t\t});\r\n\t}\r\n\r\n\tonDismissSuspendSidewalk() {\r\n\t\tthis.setState({\r\n\t\t\tsameSidewalkRatingError: false\r\n\t\t});\r\n\t}\r\n\r\n\tonRateSuspendThirty() {\r\n\t\tthis.setState({\r\n\t\t\tthirtySecondRatingError: true\r\n\t\t});\r\n\t}\r\n\r\n\tonDismissRateSuspendThirty() {\r\n\t\tthis.setState ({\r\n\t\t\tthirtySecondRatingError: false\r\n\t\t});\r\n\t}\r\n\r\n\tonDismissRatingsSuccessMessage() {\r\n\t\tthis.setState({\r\n\t\t\tsuccessfullyUploadedRatings: false\r\n\t\t});\r\n\t}\r\n\r\n\tonDismissRatingsFailureMessage() {\r\n\t\tthis.setState({\r\n\t\t\tfailedUploadingRatings: false\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Removes the specified comment from the currently loaded sidewalk\r\n\t * @param {Object} comment - the comment to remove\r\n\t */\r\n\tonRemoveLoadedComment(comment) {\r\n\t\tconst currentSidewalkComments = this.state.currentSidewalk.comments.slice(),\r\n\t\t\tindex = currentSidewalkComments.indexOf(comment);\r\n\t\tif (index !== -1) {\r\n\t\t\tconst newTotalComments = this.state.currentSidewalk.totalComments - 1;\r\n\t\t\tcurrentSidewalkComments.splice(index, 1);\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrentSidewalk: Object.assign(this.state.currentSidewalk, {comments: currentSidewalkComments, totalComments: newTotalComments})\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Removes the specified image from the currently loaded sidewalk\r\n\t * @param {Object} image - the image to remove\r\n\t * @param {function} onLastImageDeleted - a callback function that will be called if the deleted image is the last loaded one\r\n\t * @param {function} onNoImagesRemaining - a callback function that will be called if there are no images remaining\r\n\t */\r\n\tonRemoveLoadedImage(image, onLastImageDeleted, onNoImagesRemaining) {\r\n\t\tconst index = this.state.loadedUserImages.indexOf(image);\r\n\t\tif (index !== -1) {\r\n\t\t\tconst newImagesCount = this.state.currentSidewalk.totalImages - 1,\r\n\t\t\t\tnewImages = this.state.loadedUserImages.slice(),\r\n\t\t\t\tsidewalkOverride = {totalImages: newImagesCount};\t\t\t\r\n\t\t\tnewImages.splice(index, 1);\r\n\t\t\tif (this.state.currentSidewalk.lastImage === image) {\r\n\t\t\t\tsidewalkOverride.lastImage = newImages[0] || null;\r\n\t\t\t}\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrentSidewalk: Object.assign(this.state.currentSidewalk, sidewalkOverride),\r\n\t\t\t\tloadedUserImages: newImages\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (index === newImages.length && index > 0) {\r\n\t\t\t\tonLastImageDeleted(index);\r\n\t\t\t}\r\n\t\t\tif (newImages.length === 0) {\r\n\t\t\t\treturn onNoImagesRemaining();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads comments from the database\r\n\t * @param {number} startIndex - the amount of images to skip before starting to return them\r\n\t * @param {number} endIndex - the index of the last item to load\r\n\t * @param {function} updateStateCallback - a callback function that will be invoked when the comments are loaded\r\n\t */\r\n\tonLoadComments(startIndex, endIndex, updateStateCallback) {\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${this.state.currentSidewalk.id}/comment`, {\r\n\t\t\tstartIndex: startIndex,\r\n\t\t\tendIndex: endIndex\r\n\t\t}).then((res) => {\r\n\t\t\tconst currentSidewalkComments = this.state.currentSidewalk.comments.slice().concat(res.comments);\r\n\t\t\tthis.setState({\r\n\t\t\t\thasNextCommentsPage: res.hasMoreComments,\r\n\t\t\t\tcurrentSidewalk: Object.assign(this.state.currentSidewalk, { comments: currentSidewalkComments })\r\n\t\t\t});\r\n\t\t\treturn updateStateCallback();\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Loads rating information for the currently selected sidewalk\r\n\t * @param {function} successCallback - a callback function that will be invoked when the ratings are updated\r\n\t */\r\n\tonGetSidewalkRatings(successCallback) {\r\n\t\tRestUtil.sendGetRequest(`sidewalk/${this.state.currentSidewalk.id}/ratings`).then((res) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrentSidewalk: Object.assign(this.state.currentSidewalk, res)\r\n\t\t\t});\r\n\t\t\treturn successCallback();\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Synchronizes the sidewalk's various rating values between ArcGIS and Django\r\n\t */\r\n\tsynchronizeSidewalk() {\r\n\t\tconst query = window.featureLayer.createQuery();\r\n\t\tquery.outFields = [\"*\"];\r\n\t\twindow.featureLayer.queryFeatures(query).then(response => {\r\n\t\t\tif (response.features.length !== 0) {\r\n\t\t\t\tfor (const matchingSidewalk of response.features) {\r\n\t\t\t\t\tif (this.state.currentSidewalk.id === parseInt(matchingSidewalk.attributes.osm_id)) {\r\n\t\t\t\t\t\tif (Math.round(this.state.currentSidewalk.overallRating) !== matchingSidewalk.attributes.AvgOverall) {\r\n\t\t\t\t\t\t\tmatchingSidewalk.attributes.AvgOverall = Math.round(this.state.currentSidewalk.overallRating);\r\n\t\t\t\t\t\t\tmatchingSidewalk.attributes.AvgAccessibility = this.state.currentSidewalk.accessibility\r\n\t\t\t\t\t\t\tmatchingSidewalk.attributes.AvgComfort = this.state.currentSidewalk.comfort\r\n\t\t\t\t\t\t\tmatchingSidewalk.attributes.AvgConnectivity = this.state.currentSidewalk.connectivity\r\n\t\t\t\t\t\t\tmatchingSidewalk.attributes.AvgSecurity = this.state.currentSidewalk.senseOfSecurity\r\n\t\t\t\t\t\t\tmatchingSidewalk.attributes.AvgSafety = this.state.currentSidewalk.physicalSafety\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst edits = {\r\n\t\t\t\t\t\t\t\tupdateFeatures: [matchingSidewalk]\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\twindow.featureLayer.applyEdits(edits)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.error(\"Failed query part\", err);\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Performs the GET request to the API which returns the individual sidewalk data which will be exported to CSV\r\n\t * @param {number} sidewalkId - the id of the sidewalk to download CSV data for\r\n\t */\r\n\tonDownloadSidewalkCSV(sidewalkId) {\r\n\t\tRestUtil.sendGetRequest(`sidewalk/completeSummary`).then((allSidewalkObjects) => {\r\n\t\t\tconst singleSidewalkData = [];\r\n\t\t\tsingleSidewalkData.push(['SidewalkId', 'AccessibilityRating', 'Comfort', 'Connectivity', 'SenseOfSecurity', 'PhysicalSafety', 'OverallRating', 'TotalRatings', 'TotalComments', 'TotalImages']);\r\n\t\t\tallSidewalkObjects.sidewalks.forEach((sidewalk) => {\r\n\t\t\t\tif (sidewalk.id === sidewalkId) {\r\n\t\t\t\t\tsingleSidewalkData.push([sidewalk.id, sidewalk.accessibility, sidewalk.comfort, sidewalk.connectivity, sidewalk.senseOfSecurity, sidewalk.physicalSafety, sidewalk.overallRating, sidewalk.ratings, sidewalk.comments, sidewalk.images]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.setState({\r\n\t\t\t\tsidewalkCSVInfo: allSidewalkObjects,\r\n\t\t\t\tsidewalkCsvFormatted: singleSidewalkData,\r\n\t\t\t\tsidewalkHasCSVData: true\r\n\t\t\t});\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n}","import Reflux from \"reflux\";\r\n\r\nconst Actions = Reflux.createActions([\r\n\t\"deleteComment\",\r\n\t\"dismissCommentSuccessMessage\",\r\n\t\"dismissCommentErrorMessage\",\r\n\t\"checkCredentials\",\r\n\t\"logoutAdmin\",\r\n\t\"deleteImage\",\r\n\t\"dismissImageSuccessMessage\",\r\n\t\"dismissImageErrorMessage\",\r\n\t\"dismissLoginSuccess\", \r\n\t\"dismissLoginError\",\r\n\t\"getUnapprovedImages\",\r\n\t\"handlePendingImages\",\r\n\t\"dismissImageApprovalNotification\",\r\n\t\"dismissImageRejectionNotification\"\r\n]);\r\n\r\nexport default Actions;","export const LOCAL_STORAGE_NAME = \"LoginAttempts\",\r\n\tSUSPENSION_COOKIE = \"Suspended\",\r\n\tCOOKIE_EXPIRE_TIME = 1,\r\n\tMAX_LOGIN_ATTEMPTS = 3;","/**\r\n * Provides functions for preventing user spam of certain functionalities of the application\r\n */\r\nexport default class SpamUtil {\r\n\r\n\t/**\r\n\t * Sets up local storage element for the browser with numerical value\r\n\t * @param {String} name of LocalStorage element\r\n\t */\r\n    static setLocalStorage(name){\r\n        if(localStorage[name] === undefined){\r\n\t\t\tlocalStorage[name] = 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlocalStorage[name] = Number(localStorage[name]) + 1\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets up local storage with string value\r\n\t * @param {String} name name of the storage\r\n\t * @param {String} value value of the storage\r\n\t */\r\n\tstatic setValueLocalStorage(name, value){\r\n\t\tlocalStorage.setItem(name, value);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the value of the local storage \r\n\t * @param {String} name of the local storage\r\n\t * @returns the local storage value\r\n\t */\r\n    static getLocalStorage(name){\r\n        return localStorage[name];\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes the local storage\r\n\t * @param {String} name of the local storage\r\n\t */\r\n\tstatic deleteLocalStorage(name) {\r\n\t\tlocalStorage.removeItem(name);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Creates a cookie with an expiry time given in minutes\r\n\t * @param {String} cname name of the cookie\r\n\t * @param {String} cvalue value of the cookie\r\n\t * @param {Number} minute how long will the cookie last\r\n\t * @param {String} pathValue what path the cookie is set on\r\n\t */\r\n\tstatic setCookie(cname, cvalue, minute, pathValue) {\r\n\t\tlet d = new Date();\r\n\t\td.setTime(d.getTime() + (minute*60*1000));\r\n\t\tlet expires = \"expires=\"+ d.toUTCString();\r\n\t\tdocument.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/\" + pathValue;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Creates a cookie with an expiry time given in minutes\r\n\t * @param {String} cname name of the cookie\r\n\t * @param {String} cvalue value of the cookie\r\n\t * @param {String} pathValue what path the cookie is set on\r\n\t */\r\n\tstatic setCookieNoExpire(cname, cvalue, pathValue) {\r\n\t\tdocument.cookie = cname + \"=\" + cvalue + \";path=/\" + pathValue;\r\n\t}\r\n\r\n\tstatic deleteCookie(name){\r\n\t\tdocument.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';\r\n\t}\r\n\r\n\t/**\r\n\t * Get the value of the cookie\r\n\t * @param {String} cname cookie name\r\n\t * @returns the value of the cookie\r\n\t */\r\n\tstatic getCookie(cname){\r\n\t\tlet name = cname + \"=\";\r\n\t\tconst ca = decodeURIComponent(document.cookie).split(';');\r\n\t\tfor (let i = 0; i < ca.length; ++i) {\r\n\t\t\tlet c = ca[i];\r\n\t\t\twhile (c.charAt(0) === ' ') {\r\n\t\t\t\tc = c.substring(1);\r\n\t\t\t}\r\n\t\t\tif (c.indexOf(name) === 0) {\r\n\t\t\t\treturn c.substring(name.length, c.length);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n}","import Reflux from \"reflux\";\r\n\r\nimport Actions from \"./AdminActions\";\r\nimport RestUtil from \"../util/RestUtil\";\r\nimport {LOCAL_STORAGE_NAME, SUSPENSION_COOKIE} from \"../constants/AdminConstants\";\r\nimport SpamUtil from \"../util/SpamUtil\";\r\n\r\n/**\r\n * This store keeps track of the state of components that deal with administrator actions\r\n */\r\nexport default class AdminStore extends Reflux.Store {\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n\t\t\tisLoggedIn: false,\r\n\t\t\tisDeletingComment: false,\r\n\t\t\tsuccessfullyDeletedComment: false,\r\n\t\t\tfailedDeleteComment: false,\r\n\t\t\tusername: \"\",\r\n\t\t\tpassword: \"\",\r\n\t\t\tcredentialError: false,\r\n\t\t\tpendingImages: [],\r\n\t\t\tisNextPageLoading: false\r\n\t\t};\r\n        this.listenables = Actions;\r\n\r\n\t\tif (process.env.NODE_ENV === \"development\"){\r\n\t\t\twindow.DEV_ADMIN_STORE = this;\r\n\t\t}\r\n    }\r\n\r\n\t/**\r\n\t * Handles attempting to delete a comment\r\n\t * @param {String} sidewalkId - the ID of the sidewalk the comment is linked to\r\n\t * @param {String} commentId - the ID of the comment to delete\r\n\t * @param {function} onFinish - callback function that is called once the request has been resolved. \r\n\t *\t\t\t\t\t The first parameter indicates whether the request was succesful or not\r\n\t */\r\n\tonDeleteComment(sidewalkId, commentId, onFinish) {\r\n\t\tthis.setState({\r\n\t\t\tisDeletingComment: true,\r\n\t\t\tsuccessfullyDeletedComment: false,\r\n\t\t\tfailedDeleteComment: false\r\n\t\t});\r\n\t\t\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${sidewalkId}/comment/delete`, {\r\n\t\t\tid: commentId,\r\n\t\t\tusername: this.state.username,\r\n\t\t\tpassword: this.state.password\r\n\t\t}).then(() => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisDeletingComment: false,\r\n\t\t\t\tsuccessfullyDeletedComment: true\r\n\t\t\t});\r\n\t\t\treturn onFinish(true);\r\n\t\t}).catch((err) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisDeletingComment: false,\r\n\t\t\t\tfailedDeleteComment: true\r\n\t\t\t});\r\n\t\t\tonFinish(false);\r\n\t\t\tconsole.error(err);\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dismisses the message that notifies the user that they have successfully deleted a comment\r\n\t */\r\n\tonDismissCommentSuccessMessage() {\r\n\t\tthis.setState({\r\n\t\t\tsuccessfullyDeletedComment: false\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dismisses the message that notifies the user that they have failed to deleted a comment\r\n\t */\r\n\tonDismissCommentErrorMessage() {\r\n\t\tthis.setState({\r\n\t\t\tfailedDeleteComment: false\r\n\t\t});\r\n\t}\r\n\r\n\tonCheckCredentials(user, pass) {\r\n\t\tRestUtil.sendPostRequest('adminAccount/login',{\r\n\t\t\tusername: user,\r\n\t\t\tpassword: pass\r\n\t\t}).then((res) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisLoggedIn: true,\r\n\t\t\t\tsuccessfullyLoggedIn: true,\r\n\t\t\t\tusername: user,\r\n\t\t\t\tpassword: pass\r\n\t\t\t});\r\n\t\t}).catch((err) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisLoggedIn: false,\r\n\t\t\t\tfailedToLogIn: true\r\n\t\t\t});\r\n\t\t\tif (err.statusCode === 401) {\r\n\t\t\t\tif (SpamUtil.getCookie(SUSPENSION_COOKIE) !== true) {\r\n\t\t\t\t\tSpamUtil.setLocalStorage(LOCAL_STORAGE_NAME)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconsole.error(err)\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Logs the admin out and sets the state to false\r\n\t */\r\n\r\n\tonLogoutAdmin(){\r\n\t\tthis.setState({\r\n\t\t\tisLoggedIn: false\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Handles attempting to delete an image\r\n\t * @param {String} sidewalkId - the ID of the sidewalk the image is linked to\r\n\t * @param {String} imageId - the ID of the image to delete\r\n\t * @param {function} onFinish - callback function that is called once the request has been resolved. \r\n\t *\t\t\t\t\t The first parameter indicates whether the request was succesful or not\r\n\t */\r\n\tonDeleteImage(sidewalkId, imageId, onFinish){\r\n\t\tthis.setState({\r\n\t\t\tisDeletingImage: true,\r\n\t\t\tsuccessfullyDeletedImage: false,\r\n\t\t\tfailedDeleteImage: false\r\n\t\t});\r\n\t\t\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${sidewalkId}/image/delete`, {\r\n\t\t\timageId: imageId,\r\n\t\t\tusername: this.state.username,\r\n\t\t\tpassword: this.state.password\r\n\t\t}).then(() => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisDeletingImage: false,\r\n\t\t\t\tsuccessfullyDeletedImage: true\r\n\t\t\t});\r\n\t\t\treturn onFinish(true);\r\n\t\t}).catch((err) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisDeletingImage: false,\r\n\t\t\t\tfailedDeleteImage: true\r\n\t\t\t});\r\n\t\t\tconsole.error(err);\r\n\t\t\treturn onFinish(false);\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dismisses the message that notifies the user that they have successfully deleted an image\r\n\t */\r\n\tonDismissImageSuccessMessage() {\r\n\t\tthis.setState({\r\n\t\t\tsuccessfullyDeletedImage: false\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dismisses the message that notifies the user that they have failed to deleted an image\r\n\t */\r\n\tonDismissImageErrorMessage(){\r\n\t\tthis.setState({\r\n\t\t\tfailedDeleteImage: false\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Dismisses the message that notifies the user that they have successfully deleted a comment\r\n\t */\r\n\tonDismissLoginSuccess() {\r\n\t\tthis.setState({\r\n\t\t\tsuccessfullyLoggedIn: false\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Dismisses the message that notifies the user that they have successfully deleted a comment\r\n\t */\r\n\tonDismissLoginError() {\r\n\t\tthis.setState({\r\n\t\t\tfailedToLogIn: false\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Approve or reject the specified image\r\n\t * @param {boolean} accepted - whether the image is approved or not\r\n\t * @param {Number} imageId - the id of the image to approve\r\n\t * @param {Number} sidewalkId - the id of the sidewalk the image was posted to\r\n\t * @param {function} onLastImageDeleted - a callback function that will be called if the image is the last loaded one\r\n\t */\r\n\tonHandlePendingImages(accepted, imageId, sidewalkId, onLastImageDeleted) {\r\n\t\tthis.setState({\r\n\t\t\trespondingToImage: true,\r\n\t\t\tsuccessfullyRespondedToImage: false,\r\n\t\t\tfailedToRespondToImage: false\r\n\t\t});\r\n\t\tRestUtil.sendPostRequest(`sidewalk/${sidewalkId}/image/respond`, {\r\n\t\t\tusername: this.state.username,\r\n\t\t\tpassword: this.state.password,\r\n\t\t\taccepted: accepted,\r\n\t\t\timageId: imageId\r\n\t\t}).then((result) => {\r\n\t\t\tconst index = this.state.pendingImages.findIndex((img) => img.id === imageId);\r\n\t\t\tconst newImages = this.state.pendingImages.slice();\r\n\t\t\tnewImages.splice(index, 1);\r\n\t\t\tthis.setState({\r\n\t\t\t\trespondingToImage: false,\r\n\t\t\t\tsuccessfullyRespondedToImage: true,\r\n\t\t\t\tpendingImages: newImages\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (index === newImages.length && index > 0) {\r\n\t\t\t\treturn onLastImageDeleted(index);\r\n\t\t\t}\r\n\t\t}).catch((error) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\trespondingToImage: false,\r\n\t\t\t\tfailedToRespondToImage: true\r\n\t\t\t});\r\n\t\t\tconsole.error(error);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Fetches images for admins to approve and reject. Load on demand for performance purposes\r\n\t * @param {Number} startIndex the start index to get the indices from pending images\r\n\t * @param {Number} endIndex  the end index to grab the index of the last image to render\r\n\t */\r\n\r\n\tonGetUnapprovedImages(startIndex, endIndex) {\r\n\t\tthis.setState({\r\n\t\t\tisNextPageLoading: true\r\n\t\t});\r\n\t\tRestUtil.sendPostRequest(`sidewalk/unapprovedImages`, { \r\n\t\t\tusername: this.state.username,\r\n\t\t\tpassword: this.state.password,\r\n\t\t\tstartIndex: startIndex,\r\n\t\t\tendIndex: endIndex\r\n\t\t}).then((result) => {\r\n\t\t\tconst newImages = this.state.pendingImages.slice().concat(result.images);\r\n\t\t\tthis.setState({\r\n\t\t\t\thasMoreImages: result.hasMoreImages,\r\n\t\t\t\tpendingImages: newImages,\r\n\t\t\t\tisNextPageLoading: false\r\n\t\t\t});\r\n\t\t}).catch((error) => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisNextPageLoading: false\r\n\t\t\t});\r\n\t\t\tconsole.error(error);\r\n\t\t})\r\n\t}\r\n\t\r\n\t// Dismisses the approval notification\r\n\tonDismissImageApprovalNotification() {\r\n\t\tthis.setState({\r\n\t\t\tsuccessfullyRespondedToImage: false,\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Dismisses the image rejected notification \r\n\tonDismissImageRejectionNotification() {\r\n\t\tthis.setState({\r\n\t\t\tfailedToRespondToImage: false,\r\n\t\t});\r\n\t}\r\n\r\n}","import moment from \"moment\";\r\n\r\nconst months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n\r\n/**\r\n * Provides utility functions for working with dates\r\n */\r\nexport default class DateUtilities {\r\n\r\n\t/**\r\n\t * Formates a date object for display on the UI\r\n\t * @param {Date} date - the date to format\r\n\t * @return {String} - the formatted date to display\r\n\t */\r\n\tstatic formatDateForDisplay(date) {\r\n\t\treturn moment(date).format(\"MMMM DD, YYYY - h:mm A\")\r\n\t}\r\n\r\n\t/**\t\r\n\t * Gets the name of the month matching the specified month number\t\r\n\t * @param {number} monthNumber - the month number to get the name of (1 - 12)\t\r\n\t * @return {String} - the name of the month matching the specified month number\t\r\n\t */\t\r\n\tstatic getMonthName(monthNumber) {\t\r\n\t\treturn months[monthNumber - 1];\t\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\n\r\nimport DateUtilities from \"../../util/DateUtilities\";\r\nimport Store from \"../../admin/AdminStore\";\r\n\r\n/**\r\n * This class renders details about a comment left on a sidewalk\r\n */\r\nexport default class SidewalkCommentComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t_handleDelete = () => {\r\n\t\tthis.props.onDelete(this.props.details);\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Card className=\"commentDisplayBox\">\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.isLoggedIn && (\r\n\t\t\t\t\t\t<CloseIcon onClick={this._handleDelete} className=\"closeButton\" />\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\t<h5>{this.props.details.text}</h5>\r\n\t\t\t\t<h6>{DateUtilities.formatDateForDisplay(new Date(this.props.details.date))}</h6>\r\n\t\t\t</Card>\r\n\t\t)\r\n\t}\r\n}","import React from \"react\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\n\r\n/**\r\n * This component represents the loading spinner that is displayed when an asynchronous action is performed\r\n */\r\nexport default class LoaderComponent extends React.Component {\r\n\t\r\n\trender() {\r\n\t\treturn <CircularProgress />;\r\n\t}\r\n\t\r\n}","import React from \"react\";\r\nimport {Modal, Button} from \"react-bootstrap\";\r\n\r\nimport MaterialModal from '@material-ui/core/Modal';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nconst styles = theme => ({\r\n  paper: {\r\n    width: \"50%\",\r\n    backgroundColor: theme.palette.background.paper,\r\n    boxShadow: theme.shadows[5],\r\n    padding: theme.spacing.unit * 4,\r\n\tmargin: \"auto\",\r\n\tposition: \"relative\",\r\n\ttop: \"50%\",\r\n\ttransform: \"translateY(-50%)\"\r\n  },\r\n});\r\n\r\n/**\r\n * This component renders a modal that allows the user to select an image from their local files,\r\n * and then upload that image to the database. The user's selected image will be previewed in this modal.\r\n */\r\nclass ConfirmationModal extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the user closing the modal\r\n\t */\r\n\t_cancel = () => {\r\n\t\tthis.props.onCancel();\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user selecting the confirm button\r\n\t */\r\n\t_confirm = () => {\r\n\t\tthis.props.onConfirm();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<MaterialModal\r\n\t\t\t  open={this.props.visible}\r\n\t\t\t  onClose={this._cancel}\r\n\t\t\t>\r\n\t\t\t\t<div className={classes.paper}>\r\n\t\t\t\t\t<Modal.Header>\r\n\t\t\t\t\t\t<Modal.Title>{this.props.title}</Modal.Title>\r\n\t\t\t\t\t</Modal.Header>\r\n\t\t\t\t\t<div className=\"marginUpDown15\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.props.body\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t\t<Button onClick={this._cancel}>Cancel</Button>\r\n\t\t\t\t\t\t<Button bsStyle=\"primary\" onClick={this._confirm} disabled={this.props.disabledConfirm}>Confirm</Button>\r\n\t\t\t\t\t</Modal.Footer>\r\n\t\t\t\t</div>\r\n\t\t\t</MaterialModal>\r\n\t\t)\r\n\t}\r\n\r\n}\r\n\r\nexport default withStyles(styles)(ConfirmationModal)","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport LoaderComponent from \"../../misc-components/LoaderComponent\";\r\nimport ConfirmationModal from \"../../misc-components/ConfirmationModal\";\r\n\r\nimport Store from \"../../admin/AdminStore\";\r\nimport Actions from \"../../admin/AdminActions\";\r\n\r\n/**\r\n * This component renders a modal that allows an administrator to delete a user's comment on a sidewalk\r\n */\r\nexport default class CommentDeletionModal extends Reflux.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.store = Store;\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the user closing the modal\r\n\t */\r\n\t_cancel = () => {\r\n\t\tthis.props.onClose();\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user selecting the confirm button\r\n\t */\r\n\t_confirm = () => {\r\n\t\tActions.deleteComment(this.props.sidewalkId, this.props.comment.id, (success) => {\r\n\t\t\tif (success) {\r\n\t\t\t\tthis.props.onClose(true);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\trenderModalBody() {\r\n\t\tif (!this.props.visible) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<p className=\"wrapText\">{this.props.comment.text}</p>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.isDeletingComment && <LoaderComponent />\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ConfirmationModal title=\"Are you sure you want to delete this comment?\"\r\n\t\t\t\t\t\t\t   body={this.renderModalBody()}\r\n\t\t\t\t\t\t\t   onCancel={this._cancel}\r\n\t\t\t\t\t\t\t   onConfirm={this._confirm}\r\n\t\t\t\t\t\t\t   visible={this.props.visible}\r\n\t\t\t\t\t\t\t   disabledConfirm={this.state.isDeletingComment}\r\n\t\t    />\r\n\t\t)\r\n\t}\r\n\r\n}\r\n","export const COMMENTS_PER_PAGE = 25,\r\n\tCOMMENT_ERROR_STATE = \"error\",\r\n\tCOMMENT_PROFANITY_MESSAGE = \"This comment has profanity or personal information in it.\",\r\n\tEMPTY_COMMENT_MESSAGE = \"You can not post an empty comment.\",\r\n\t// taken from https://stackoverflow.com/a/39418863\r\n\tPHONE_REGEX = /(?:(?:\\+?1\\s*(?:[.-]\\s*)?)?(?:\\(\\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\\s*\\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\\s*(?:[.-]\\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\\s*(?:[.-]\\s*)?([0-9]{4})(?:\\s*(?:#|x\\.?|ext\\.?|extension)\\s*(\\d+))?/img,\r\n\tSECONDARY_PHONE_REGEX = /[0-9]{3}.[0-9]{3}.[0-9]{4}/;","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\nimport { Button, FormGroup, FormControl, Alert } from \"react-bootstrap\";\r\nimport Filter from \"bad-words\";\r\nimport swearsList from \"bad-words/lib/lang\";\r\n\r\nimport SidewalkStore from \"../SidewalkStore\";\r\nimport SidewalkActions from \"../SidewalkActions\";\r\nimport SidewalkCommentComponent from \"./SidewalkCommentComponent\";\r\nimport CommentDeletionModal from \"./CommentDeletionModal\";\r\nimport LoaderComponent from \"../../misc-components/LoaderComponent\";\r\nimport SpamUtil from \"../../util/SpamUtil\";\r\n\r\nimport {COMMENTS_PER_PAGE, COMMENT_ERROR_STATE, COMMENT_PROFANITY_MESSAGE, EMPTY_COMMENT_MESSAGE, PHONE_REGEX, SECONDARY_PHONE_REGEX} from \"../../constants/CommentConstants\";\r\n\r\nconst filter = new Filter({ replaceRegex: /^[+]?[(]?[0-9]{3}[)]?[-\\s.]?[0-9]{3}[-\\s.]?[0-9]{4,6}$/im, placeHolder: \"*\"});\r\nfilter.addWords('@');\r\n\r\n/**\r\n * This class renders the list of all comments left on a sidewalk, as well as the form for\r\n * posting new comments\r\n */\r\nexport default class CommentsListComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = SidewalkStore;\r\n\t\tthis.state = {\r\n\t\t\tenteredComment: \"\",\r\n\t\t\tmodalOpened: false,\r\n\t\t\tisLoadingComments: false,\r\n\t\t\tcurrentPage: 0,\r\n\t\t\tcommentValidation: {\r\n\t\t\t\tstate: COMMENT_ERROR_STATE,\r\n\t\t\t\tmessage: EMPTY_COMMENT_MESSAGE\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Determines whether the current input text is valid or not\r\n\t * @param {String} comment - the comment to validate\r\n\t * @return {Object} - details about whether the input text is valid or not\r\n\t * {\r\n\t *\t\tstate: \t a representation whether the current comment text can be posted or not (\"error\" or \"success\")\r\n\t *\t\tmessage: a reason why the comment can not be posted, if state is error\r\n\t * }\r\n\t */\r\n\t_validateCommentState = (comment) => {\r\n\t\tconst length = comment.length;\r\n\r\n\t\tif (comment.match(PHONE_REGEX)) {\r\n\t\t\treturn {\r\n\t\t\t\tstate: COMMENT_ERROR_STATE,\r\n\t\t\t\tmessage: `This comment contains a phone number: ${comment.match(PHONE_REGEX)[0]}`\r\n\t\t\t};\r\n\t\t} else if (comment.match(SECONDARY_PHONE_REGEX)) {\r\n\t\t\treturn {\r\n\t\t\t\tstate: COMMENT_ERROR_STATE,\r\n\t\t\t\tmessage: `This comment contains a phone number: ${comment.match(SECONDARY_PHONE_REGEX)[0]}`\r\n\t\t\t};\r\n\t\t} else if (length === 0) {\r\n\t\t\treturn {\r\n\t\t\t\tstate: COMMENT_ERROR_STATE,\r\n\t\t\t\tmessage: EMPTY_COMMENT_MESSAGE\r\n\t\t\t};\r\n\t\t} else if (length <= 300) {\r\n\t\t\treturn {\r\n\t\t\t\tstate: \"success\",\r\n\t\t\t\tmessage: \"\"\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tstate: COMMENT_ERROR_STATE,\r\n\t\t\tmessage: \"Comments can be no more than 300 characters.\"\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Performs extra validation of the specified comment to make sure it does not have swears or personal information\r\n\t * Separated from _validateCommentState() due to performance reasons\r\n\t * @param {String} comment - the comment to validate\r\n\t * @return {Object} - details about whether the input text is valid or not\r\n\t * {\r\n\t *\t\tstate: \t a representation whether the current comment text can be posted or not (\"error\" or \"success\")\r\n\t *\t\tmessage: a reason why the comment can not be posted, if state is error\r\n\t * }\r\n\t */\r\n\t_performDetailedCommentValidation = (comment) => {\r\n\t\tfor (const swear of swearsList.words) {\r\n\t\t\tif (swear === \"hell\" || swear.includes(\"as\")) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (comment.toLowerCase().includes(swear)) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tstate: COMMENT_ERROR_STATE,\r\n\t\t\t\t\tmessage: COMMENT_PROFANITY_MESSAGE\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (filter.isProfane(comment)) {\r\n\t\t\treturn {\r\n\t\t\t\tstate: COMMENT_ERROR_STATE,\r\n\t\t\t\tmessage: COMMENT_PROFANITY_MESSAGE\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\tstate: \"success\",\r\n\t\t\tmessage: \"\"\r\n\t\t};\r\n\t};\r\n\t\r\n\t_onCommentBlur = () => {\r\n\t\tconst validation = this._performDetailedCommentValidation(this.state.enteredComment);\r\n\t\tif (validation.state === COMMENT_ERROR_STATE) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tcommentValidation: validation\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user changing their comment text value\r\n\t */\r\n\t_handleChange = (e) => {\r\n\t\tthis.setState({ \r\n\t\t\tenteredComment: e.target.value,\r\n\t\t\tcommentValidation: this._validateCommentState(e.target.value)\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Handles comment spamming, make sure no more than 3 comment per 30 second or no more than 3 per sidewalk per day\r\n\t */\r\n\r\n\t_handleCheck = () => {\r\n\t\tif (!SpamUtil.getCookie(\"commentTimer\")) {\r\n\t\t\tSpamUtil.deleteLocalStorage(\"sidewalkCommented\");\r\n\t\t}\r\n\r\n\t\tif (!SpamUtil.getCookie(\"timer\" + this.state.currentSidewalk.id)) {\r\n\t\t\tSpamUtil.deleteLocalStorage(\"count\"+this.state.currentSidewalk.id);\r\n\t\t}\r\n\r\n\t\tif (SpamUtil.getCookie(\"timer\" + this.state.currentSidewalk.id) === \"true\" && Number(SpamUtil.getLocalStorage(\"count\"+this.state.currentSidewalk.id)) + 1 > 3) {\r\n\t\t\tSidewalkActions.suspendedSidewalkComment();\r\n\t\t} else if (SpamUtil.getCookie(\"commentTimer\") === \"true\" && Number(SpamUtil.getLocalStorage(\"sidewalkCommented\")) + 1 > 3) {\r\n\t\t\tSidewalkActions.commentSuspendThirty();\r\n\t\t} else {\r\n\t\t\tthis._handleSubmit();\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Handles the user submitting their entered comment text\r\n\t */\r\n\t_handleSubmit = () => {\r\n\t\tconst validateComment = this._performDetailedCommentValidation(this.state.enteredComment);\r\n\t\tif (validateComment.state === COMMENT_ERROR_STATE) {\r\n\t\t\tthis.setState({commentValidation: validateComment});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tSidewalkActions.uploadComment(this.state.enteredComment);\r\n\r\n\t\tSpamUtil.setLocalStorage(\"sidewalkCommented\");\r\n\t\tSpamUtil.setLocalStorage(\"count\"+this.state.currentSidewalk.id);\r\n\t\t\r\n\t\tif(Number(SpamUtil.getLocalStorage(\"sidewalkCommented\"))===1){\r\n\t\t\tSpamUtil.setCookie(\"commentTimer\", \"true\", 0.5, \"\");\r\n\t\r\n\t\t}\r\n\r\n\t\tif(Number(SpamUtil.getLocalStorage(\"count\"+this.state.currentSidewalk.id))===1){\r\n\t\t\tSpamUtil.setCookie(\"timer\"+this.state.currentSidewalk.id, \"true\", 24*60, \"\");\t\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tenteredComment: \"\",\r\n\t\t\tcommentValidation: this._validateCommentState(\"\")\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\t_openConfirmationModal = (selectedComment) => {\r\n\t\tthis.setState({\r\n\t\t\tmodalOpened: true,\r\n\t\t\tselectedComment: selectedComment\r\n\t\t});\r\n\t};\r\n\t\r\n\t_closeConfirmationModal = (deleted) => {\r\n\t\tif (deleted) {\r\n\t\t\tSidewalkActions.removeLoadedComment(this.state.selectedComment);\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tmodalOpened: false,\r\n\t\t\tselectedComment: null\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Gets whether the specified item is loaded\r\n\t * @param {number} index - the index of the item in the list of all loaded items\r\n\t * @return {boolean} - whether the specified item is loaded\r\n\t */\r\n\t_isRowLoaded = ({index}) => {\r\n\t\treturn Boolean(this.state.currentSidewalk.comments[index]);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Loads more items\r\n\t * @param {number} startIndex - the starting index of new items to load\r\n\t * @param {number} stopIndex - the ending index of new items to load\r\n\t */\r\n\t_loadMoreRows = (startIndex, stopIndex) => {\r\n\t\tthis.setState({\r\n\t\t\tisLoadingComments: true\r\n\t\t});\r\n\t\tSidewalkActions.loadComments(startIndex, stopIndex + 24, () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisLoadingComments: false\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Gets all comments loaded on the current page\r\n\t * @param {index} - the page index\r\n\t * @return {Array<Object>} - a list of all comments on the page\r\n\t */\r\n\t_getCommentsOnPage = (index) => {\r\n\t\treturn this.state.currentSidewalk.comments.slice(index * COMMENTS_PER_PAGE, (index * COMMENTS_PER_PAGE) + COMMENTS_PER_PAGE)\r\n\t};\r\n\t\r\n\t/**\r\n\t * Loads the previous comments page\r\n\t */\r\n\t_visitPreviousPage = () => {\r\n\t\tthis.setState({\r\n\t\t\tcurrentPage: this.state.currentPage - 1\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * loads the next comments page\r\n\t */\r\n\t_visitNextPage = () => {\r\n\t\tif (this.state.isLoadingComments) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this._getCommentsOnPage(this.state.currentPage + 1).length === 0) {\r\n\t\t\tthis._loadMoreRows(this.state.currentSidewalk.comments.length, this.state.currentSidewalk.comments.length + 25);\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tcurrentPage: this.state.currentPage + 1\r\n\t\t});\r\n\t};\r\n\t\r\n\trenderCurrentCommentsPage() {\r\n\t\tconst comments = this._getCommentsOnPage(this.state.currentPage);\r\n\t\tif (comments.length === 0 && this.state.hasNextCommentsPage) {\r\n\t\t\treturn <LoaderComponent />;\r\n\t\t}\r\n\r\n\t\treturn comments.map((details, index) => {\r\n\t\t\treturn <SidewalkCommentComponent details={details} key={index} onDelete={this._openConfirmationModal} />\r\n\t\t});\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tif (!this.state.currentSidewalk) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"comments\">\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.commentValidation.message.length > 0 && (\r\n\t\t\t\t\t\t<Alert bsStyle=\"danger\">\r\n\t\t\t\t\t\t\t{this.state.commentValidation.message}\r\n\t\t\t\t\t\t</Alert>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"commentBox\">\r\n\t\t\t\t\t\t<FormGroup\r\n\t\t\t\t\t\t\tbsSize=\"small\"\r\n\t\t\t\t\t\t\tcontrolId=\"formBasicText\"\r\n\t\t\t\t\t\t\tvalidationState={this.state.commentValidation.state}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<FormControl\r\n\t\t\t\t\t\t\t\tcomponentClass=\"textarea\"\r\n\t\t\t\t\t\t\t\tvalue={this.state.enteredComment}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Enter a comment\"\r\n\t\t\t\t\t\t\t\tonChange={this._handleChange}\r\n\t\t\t\t\t\t\t\tonBlur={this._onCommentBlur}\r\n\t\t\t\t\t\t\t\trows={4}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<FormControl.Feedback />\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Button bsStyle=\"primary\" onClick={this._handleCheck} disabled={this.state.uploadingComment || this.state.commentValidation.state === COMMENT_ERROR_STATE} >\r\n\t\t\t\t\tSubmit\r\n\t\t\t\t</Button>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.uploadingComment && (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\tUploading...\r\n\t\t\t\t\t\t\t<LoaderComponent />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\t<hr />\r\n\t\t\t\t\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.currentPage > 0 && <span className=\"icon glyphicon glyphicon-arrow-left\" onClick={this._visitPreviousPage} />\r\n\t\t\t\t}\r\n\t\t\t\t{\r\n\t\t\t\t\t((this.state.hasNextCommentsPage && !this.state.isLoadingComments) || this._getCommentsOnPage(this.state.currentPage + 1).length > 0) && <span className=\"nextIcon glyphicon glyphicon-arrow-right\" onClick={this._visitNextPage} />\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"commentDisplaySection\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.renderCurrentCommentsPage()\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<CommentDeletionModal comment={this.state.selectedComment}\r\n\t\t\t\t\t\t\t\t\t  sidewalkId={this.state.currentSidewalk.id}\r\n\t\t\t\t\t\t\t\t\t  onClose={this._closeConfirmationModal}\r\n\t\t\t\t\t\t\t\t\t  visible={this.state.modalOpened} />\r\n\t\t\t</div >\r\n\r\n\t\t);\r\n\t}\r\n}","export const\r\n\t/**\r\n\t * Converts bytes into megabytes\r\n\t * @param {number} bytes - the amount in bytes to convert\r\n\t * @return {number} - the input bytes value represented in megabytes form\r\n\t */\r\n\tbytesToMB = (bytes) => {\r\n\t\treturn bytes / 1048576;\r\n\t},\r\n\t/**\r\n\t * Gets a base64 encoded string of a file that a user has selected to upload\r\n\t * @param {Object} file - the file that the user has selected\r\n\t * @return {Promise} - a promise that resolves with the base64 string\r\n\t */\r\n\tgetFile = (file) => {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst reader = new FileReader();\r\n\t\t\treader.onerror = (err) => {\r\n\t\t\t\treader.abort();\r\n\t\t\t\treject(err);\r\n\t\t\t};\r\n\t\t\treader.onload = function() {\r\n\t\t\t\tresolve(this.result);\r\n\t\t\t};\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t});\r\n\t};","import React from \"react\";\r\nimport {Button, FormControl} from \"react-bootstrap\";\r\n\r\n/**\r\n * This component allows the user to select an image to upload, and it displays the name of the current\r\n * selected image.\r\n */\r\nexport default class ImageSelectorComponent extends React.Component {\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"rowImgSelector\">\r\n\t\t\t\t<FormControl\r\n\t\t\t\t   readOnly\r\n\t\t\t\t   type=\"text\"\r\n\t\t\t\t   placeholder={this.props.fileName || \"No file selected\"}\r\n\t\t\t\t />\r\n\t\t\t\t<Button\r\n\t\t\t\t\tonClick={() => this.fileInput.click()}\r\n\t\t\t\t\tbsStyle=\"primary\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\tonChange={this.props.onSelect}\r\n\t\t\t\t\t\t\tclassName=\"uploadImageInput\"\r\n\t\t\t\t\t\t\tref={(fileInput) => {this.fileInput = fileInput;}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<span className=\"imageComponentButtonText\">\r\n\t\t\t\t\t\t\tChoose File\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}","import React from \"react\";\r\nimport {Modal, Button, Alert} from \"react-bootstrap\";\r\n\r\nimport MaterialModal from '@material-ui/core/Modal';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nimport {getFile, bytesToMB} from \"../util/FileUtilities\";\r\nimport ImageSelectorComponent from \"./ImageSelectorComponent\";\r\nimport LoaderComponent from \"../misc-components/LoaderComponent\";\r\nimport {MAX_UPLOAD_SIZE} from \"../constants/DatabaseConstants\";\r\n\r\nconst styles = theme => ({\r\n  paper: {\r\n    width: \"50%\",\r\n    backgroundColor: theme.palette.background.paper,\r\n    boxShadow: theme.shadows[5],\r\n    padding: theme.spacing.unit * 4,\r\n\tmargin: \"auto\",\r\n\tposition: \"relative\",\r\n\ttop: \"50%\",\r\n\ttransform: \"translateY(-50%)\"\r\n  },\r\n});\r\n\r\n/**\r\n * This component renders a modal that allows the user to select an image from their local files,\r\n * and then upload that image to the database. The user's selected image will be previewed in this modal.\r\n */\r\nclass ImageUploadModal extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the user making a selection in the file selection dialog\r\n\t * @param {Object} event - the event representing the file selection interaction\r\n\t */\r\n\t_selectImageToUpload = (event) => {\r\n\t\tconst file = event.target.files[0];\r\n\t\tif (file && file.size <= MAX_UPLOAD_SIZE) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tloadingSelectedImage: true,\r\n\t\t\t\tselectedImageSize: null,\r\n\t\t\t\tselectedImage: null,\r\n\t\t\t\tselectedFileName: file.name\r\n\t\t\t});\r\n\t\t\tgetFile(file).then((res) => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tselectedImage: res,\r\n\t\t\t\t\tselectedImageSize: file.size,\r\n\t\t\t\t\tloadingSelectedImage: false\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else if (!this.state.selectedImage || (file && file.size > MAX_UPLOAD_SIZE)) {\r\n\t\t\t// don't overwrite any existing selected image\r\n\t\t\tthis.setState({\r\n\t\t\t\tselectedImageSize: file && file.size,\r\n\t\t\t\tselectedImage: null,\r\n\t\t\t\tselectedFileName: file && file.name,\r\n\t\t\t\tloadingSelectedImage: false\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Gets whether the large image size warnings should be rendered or not\r\n\t * @return {boolean} - whether the large image size warnings should be rendered or not\r\n\t */\r\n\t_shouldDisplaySizeWarning = () => {\r\n\t\treturn Boolean(this.state.selectedImageSize && this.state.selectedImageSize > MAX_UPLOAD_SIZE);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Gets whether the upload image should be active or not\r\n\t * @return {boolean} - whether the upload image should be active or not\r\n\t */\r\n\t_canUpload = () => {\r\n\t\treturn Boolean(this.state.selectedImage && this.state.selectedImageSize <= MAX_UPLOAD_SIZE);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user closing the modal without uploading the image\r\n\t */\r\n\t_cancel = () => {\r\n\t\tthis.setState({\r\n\t\t\tselectedImage: null,\r\n\t\t\tselectedImageSize: null,\r\n\t\t\tselectedFileName: null,\r\n\t\t\tloadingSelectedImage: false\r\n\t\t});\r\n\t\tthis.props.onClose();\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user selecting the upload button\r\n\t */\r\n\t_confirmUpload = () => {\r\n\t\tthis.props.onClose(this.state.selectedImage);\r\n\t\tthis.setState({\r\n\t\t\tselectedImage: null,\r\n\t\t\tselectedImageSize: null,\r\n\t\t\tselectedFileName: null,\r\n\t\t\tloadingSelectedImage: false\r\n\t\t});\r\n\t};\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<MaterialModal\r\n\t\t\t  open={this.props.visible}\r\n\t\t\t  onClose={this._cancel}\r\n\t\t\t>\r\n\t\t\t\t<div className={classes.paper}>\r\n\t\t\t\t\t<Modal.Header>\r\n\t\t\t\t\t\t<Modal.Title>Upload Image</Modal.Title>\r\n\t\t\t\t\t</Modal.Header>\r\n\t\t\t\t\t<div className=\"marginUpDown15\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis._shouldDisplaySizeWarning() && (\r\n\t\t\t\t\t\t\t\t<Alert bsStyle=\"danger\">\r\n\t\t\t\t\t\t\t\t\tThat image is too large. The selected image should be no more than {Math.floor(bytesToMB(MAX_UPLOAD_SIZE))} megabytes.\r\n\t\t\t\t\t\t\t\t</Alert>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<ImageSelectorComponent onSelect={this._selectImageToUpload} fileName={this.state.selectedFileName} />\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.state.selectedImage && (\r\n\t\t\t\t\t\t\t\t<div className=\"selectedImagePreview\">\r\n\t\t\t\t\t\t\t\t\t<img className=\"img-responsive\" alt=\"selected\" src={this.state.selectedImage} />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.state.loadingSelectedImage && <LoaderComponent />\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Modal.Footer>\r\n\t\t\t\t\t\t<Button onClick={this._cancel}>Cancel</Button>\r\n\t\t\t\t\t\t<Button bsStyle=\"primary\" onClick={this._confirmUpload} disabled={!this._canUpload()}>Upload</Button>\r\n\t\t\t\t\t</Modal.Footer>\r\n\t\t\t\t</div>\r\n\t\t\t</MaterialModal>\r\n\t\t)\r\n\t}\r\n\r\n}\r\n\r\nexport default withStyles(styles)(ImageUploadModal)","import React from \"react\";\r\nimport {Button} from \"react-bootstrap\";\r\n\r\n/**\r\n * This component represents the \"Upload Image\" button that is visible on a Sidewalk's details\r\n */\r\nexport default class UploadSidewalkImageComponent extends React.Component {\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Button bsStyle=\"primary\" onClick={this.props.onClick}>\r\n\t\t\t\t<span className=\"glyphicon glyphicon-camera\" />\r\n\t\t\t\t<span className=\"uploadSidewalkImageText\">\r\n\t\t\t\t\tUpload Image\r\n\t\t\t\t</span>\r\n\t\t\t</Button>\r\n\t\t);\r\n\t}\r\n\t\r\n}","import React from \"react\";\r\nimport {Button} from \"react-bootstrap\";\r\n\r\n/**\r\n * This component represents the view where the user can select to see all images uploaded to a sidewalk\r\n */\r\nexport default class PreviewSidewalkImagesComponent extends React.Component {\r\n\t\r\n\trender() {\r\n\t\tif (this.props.imageCount === 0) {\r\n\t\t\treturn (\r\n\t\t\t\t<h5>Nobody has uploaded images yet for this sidewalk.</h5>\r\n\t\t\t)\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className=\"previewSidewalkImages\">\r\n\t\t\t\t<Button bsStyle=\"primary\" onClick={this.props.onClick}>\r\n\t\t\t\t\t\tView {this.props.imageCount} images\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\t\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../SidewalkStore\";\r\nimport Actions from \"../SidewalkActions\";\r\n\r\nimport ImageUploadModal from \"../../images/ImageUploadModal\";\r\nimport UploadSidewalkImageComponent from \"./UploadSidewalkImageComponent\";\r\nimport PreviewSidewalkImagesComponent from \"./PreviewSidewalkImagesComponent\";\r\nimport LoaderComponent from \"../../misc-components/LoaderComponent\";\r\n\r\n/**\r\n * This component renders the image section of the sidewalk drawer\r\n */\r\nexport default class SidewalkImageDetailsComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t\tthis.state = {\r\n\t\t\tmodalOpened: false\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Opens up the uploaded images view\r\n\t */\r\n\t_viewImages = () => {\r\n\t\tthis.props.onOpenImages();\r\n\t};\r\n\r\n\t/**\r\n\t * Opens the modal allowing the user to upload images\r\n\t */\r\n\t_openImageModal = () => {\r\n\t\tthis.setState({\r\n\t\t\tmodalOpened: true\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * Closes the image upload modal\r\n\t * @param {String?} - the base64 encoded string representing the image the user uploaded if valid, or undefined otherwise\r\n\t */\r\n\t_closeImageModal = (uploadedFile) => {\r\n\t\tthis.setState({\r\n\t\t\tmodalOpened: false\r\n\t\t});\r\n\t\tif (uploadedFile) {\r\n\t\t\tActions.uploadSidewalkImage(uploadedFile);\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\tif (!this.state.currentSidewalk) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<PreviewSidewalkImagesComponent imageCount={this.state.currentSidewalk.totalImages} previewImage={this.state.currentSidewalk.lastImage} onClick={this._viewImages} />\r\n\t\t\t\t<UploadSidewalkImageComponent onClick={this._openImageModal} />\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.uploadingSidewalkImage && (\r\n\t\t\t\t\t\t<div className=\"marginTop10\">\r\n\t\t\t\t\t\t\t<span className=\"marginRight10\">Uploading...</span>\r\n\t\t\t\t\t\t\t<LoaderComponent />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\t<ImageUploadModal visible={this.state.modalOpened} onClose={this._closeImageModal} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport { FONT_FAMILY } from \"../constants/ThemeConstants\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    overflowX: \"auto\",\r\n  },\r\n  tableCell: {\r\n\t  fontSize: \"14px\",\r\n\t  fontWeight: theme.typography.fontWeightRegular,\r\n\t  fontFamily: FONT_FAMILY\r\n  }\r\n});\r\n\r\n/**\r\n * This component renders a table displaying details about the distribution of each activity that pedestrians\r\n * were tracked doing on a sidewalk\r\n */\r\nclass PedestrianDataComponent extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {classes} = this.props;\r\n\t\treturn (\r\n\t\t\t<Paper className={classes.root}>\r\n\t\t\t  <Table>\r\n\t\t\t\t<TableHead>\r\n\t\t\t\t  <TableRow>\r\n\t\t\t\t\t<TableCell className={classes.tableCell}>Activity</TableCell>\r\n\t\t\t\t\t<TableCell className={classes.tableCell} numeric>Percentage</TableCell>\r\n\t\t\t\t  </TableRow>\r\n\t\t\t\t</TableHead>\r\n\t\t\t\t<TableBody>\r\n\t\t\t\t  {this.props.activities.map((row, index) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t  <TableRow key={index}>\r\n\t\t\t\t\t\t<TableCell className={classes.tableCell} component=\"th\" scope=\"row\">\r\n\t\t\t\t\t\t  {row.type}\r\n\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t\t<TableCell className={classes.tableCell} numeric>{row.distributionPercent * 100}</TableCell>\r\n\t\t\t\t\t  </TableRow>\r\n\t\t\t\t\t);\r\n\t\t\t\t  })}\r\n\t\t\t\t</TableBody>\r\n\t\t\t  </Table>\r\n\t\t\t</Paper>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(PedestrianDataComponent);","export const SECONDARY_COLOUR = \"#FFEB3B\",\r\n\tFONT_FAMILY = \"Proza Libre\";","export const getRatingDescription = (rating) => {\r\n\tif (rating < 1.5) {\r\n\t\treturn \"Poor\";\r\n\t} else if (rating < 2.5) {\r\n\t\treturn \"Bad\";\r\n\t} else if (rating < 3.5) {\r\n\t\treturn \"Average\";\r\n\t} else if (rating < 4.5) {\r\n\t\treturn \"Great\";\r\n\t}\r\n\treturn \"Excellent\";\r\n};","import React from \"react\";\r\nimport { Component } from \"reflux\";\r\n\r\nimport Slider from '@material-ui/lab/Slider';\r\nimport {Button, Tooltip, OverlayTrigger} from \"react-bootstrap\";\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nimport Store from \"./SidewalkStore\";\r\nimport Actions from \"./SidewalkActions\";\r\nimport LoaderComponent from \"../misc-components/LoaderComponent\";\r\nimport {getRatingDescription} from \"../util/RatingUtil\";\r\nimport { FONT_FAMILY } from \"../constants/ThemeConstants\";\r\nimport SpamUtil from \"../util/SpamUtil\";\r\nimport {ACCESSIBILITY, CONNECTIVITY, COMFORT, SAFETY, SECURITY} from \"../constants/RatingsDescriptionConstants\";\r\n\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\twidth: \"90%\",\r\n\t\toverflowX: \"hidden\"\r\n\t},\r\n\tslider: {\r\n        padding: '15px',\r\n\t},\r\n\t\r\n\theading: {\r\n\t\tfontSize: theme.typography.pxToRem(30),\r\n\t\tfontWeight: theme.typography.fontWeightRegular,\r\n\t\tfontFamily: FONT_FAMILY\r\n\t},\r\n});\r\n\r\n/**\r\n * This component handles rendering the components that allow rating sidewalks\r\n */\r\nclass SidewalkRatingsModal extends Component {\r\n\t\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t\tthis.state = {\r\n\t\t\taccessibilityValue: 3,\r\n\t\t\tconnectivityValue: 3,\r\n\t\t\tcomfortValue: 3,\r\n\t\t\tsafetyValue: 3,\r\n\t\t\tsecurityValue: 3\r\n\t\t};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Hendles change of user rating\r\n\t */\r\n\tchangeAccessibility = (event, accessibilityValue) => {\r\n\t\tthis.setState({ accessibilityValue });\r\n\t};\r\n\t\r\n\tChangeConnectivity = (event, connectivityValue) => {\r\n\t\tthis.setState({ connectivityValue });\r\n\t};\r\n\r\n\tchangeComfort = (event, comfortValue) => {\r\n\t\tthis.setState({ comfortValue });\r\n\t};\r\n\r\n\tchangeSafety = (event, safetyValue ) => {\r\n\t\tthis.setState({ safetyValue });\r\n\t};\r\n\r\n\tchangeSecurity = (event, securityValue) => {\r\n\t\tthis.setState({ securityValue });\r\n\t};\r\n\r\n\t/**\r\n\t * Handles changes when submit rating button is clicked\r\n\t */\r\n\t_handleSubmitRating = () => {\r\n\t\tSpamUtil.setLocalStorage(\"NumberSidewalk\");\r\n\t\tif (Number(SpamUtil.getLocalStorage(\"NumberSidewalk\")) === 1){\r\n\t\t\tSpamUtil.setCookie(\"timer\", \"true\", 0.5, \"\");\r\n\t\t}\r\n\t\tSpamUtil.setCookie(this.state.currentSidewalk.id, \"true\", 60, \"\");\r\n\t\t\r\n\t\tActions.uploadRatings(\r\n\t\t\tthis.state.accessibilityValue,\r\n\t\t\tthis.state.comfortValue,\r\n\t\t\tthis.state.connectivityValue,\r\n\t\t\tthis.state.safetyValue,\r\n\t\t\tthis.state.securityValue,\r\n\t\t\t() => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\taccessibilityValue: 3, \r\n\t\t\t\t\tconnectivityValue: 3,\r\n\t\t\t\t\tcomfortValue: 3,\r\n\t\t\t\t\tsafetyValue: 3,\r\n\t\t\t\t\tsecurityValue: 3\r\n\t\t\t\t});\r\n\t\t\t\tthis.props.onClose(true);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t_submitStatus = () => {\r\n\t\treturn this.state.ratingStatus\r\n\t}\r\n\t\r\n\trenderSlider(classes, value, onChange, name, tooltipDescription) {\r\n\t\tconst tooltip = (\r\n\t\t\t<Tooltip \r\n\t\t\t\tid={name}>\r\n\t\t\t\t{tooltipDescription}\r\n\t\t\t</Tooltip>\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<OverlayTrigger placement=\"top\" overlay={tooltip}>\r\n\t\t\t\t\t<h5 className=\"ratingsHeader\">\r\n\t\t\t\t\t\t{name}\r\n\t\t\t\t\t</h5>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t\t<div className=\"ratingSlider\">\r\n\t\t\t\t\t<div className={classes.root}>\r\n\t\t\t\t\t\t<Slider\r\n\t\t\t\t\t\t\tclasses={{ container: classes.slider }}\r\n\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\tmax={5}\r\n\t\t\t\t\t\t\tstep={1}\r\n\t\t\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<span style={{paddingLeft: \"15px\"}}>\r\n\t\t\t\t\t\t{getRatingDescription(value)}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\t\r\n\trenderBody() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t{this.renderSlider(classes, this.state.accessibilityValue, this.changeAccessibility, \"Accessibility\", ACCESSIBILITY)}\r\n\t\t\t\t{this.renderSlider(classes, this.state.connectivityValue, this.ChangeConnectivity, \"Connectivity\", CONNECTIVITY)}\r\n\t\t\t\t{this.renderSlider(classes, this.state.comfortValue, this.changeComfort, \"Comfort\", COMFORT)}\r\n\t\t\t\t{this.renderSlider(classes, this.state.safetyValue, this.changeSafety, \"Physical Safety\", SAFETY)}\r\n\t\t\t\t{this.renderSlider(classes, this.state.securityValue, this.changeSecurity, \"Sense of Security\", SECURITY)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<Dialog\r\n\t\t\t\topen={this.props.open}\r\n\t\t\t\tonClose={this.props.onClose}\r\n\t\t\t>\r\n\t\t\t\t<div className={classes.paper}>\r\n\t\t\t\t\t<h4 className=\"modal-title\">Rate Sidewalk</h4>\r\n\t\t\t\t\t<DialogContent>\r\n\t\t\t\t\t\t{this.state.isUploadingRatings && <LoaderComponent />}\r\n\t\t\t\t\t\t{this.renderBody()}\r\n\t\t\t\t\t</DialogContent>\r\n\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t<Button onClick={this.props.onClose}>\r\n\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button bsStyle=\"primary\" type=\"submit\" onClick={this._handleSubmitRating} disabled={!this._submitStatus()}>\r\n\t\t\t\t\t\t\tSubmit\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</DialogActions>\r\n\t\t\t\t</div>\r\n\t\t\t</Dialog>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(SidewalkRatingsModal);","export const ACCESSIBILITY = `Accessibility refers to the availability of \r\n                                features and aids that make the space friendly for any user.\r\n                                Think about seniors, people with disabilities, children or people \r\n                                carrying a stroller: is this a space that they can easily use and enjoy? `,\r\n                CONNECTIVITY = `Connectivity refers to the place that this section of sidewalk has in the pedestrian \r\n                                    network. Do you think this sidewalk takes you to important destinations? \r\n                                    Is this sidewalk well integrated with public transit? Are there places to go in this sidewalk, \r\n                                    such as stores, a church, a school, or maybe a public space? `,\r\n                COMFORT = `Comfort refers to the extent to which this is an enjoyable space to walk. \r\n                                Think about what you can see, hear and smell: does that make you feel good? \r\n                                Is there enough room to move freely? Are there benches, plants, public washrooms or other elements \r\n                                that make walking more comfortable? `,\r\n                SAFETY = `Safety refers to being free from potential dangers that motorized traffic and any feature of the built environment can cause. \r\n                            Are there well-defined barriers between you and cars? Is the sidewalk pavement even and well maintained? `,\r\n                SECURITY = `Security refers to feeling protected from external threats, such as criminal or malicious acts. Can you trust \r\n                                the people that surround you on this sidewalk? Is this a space where you feel comfortable waiting? `\r\n                                ","import React from \"react\";\r\nimport { Component } from \"reflux\";\r\nimport SidewalkStore from \"./SidewalkStore\";\r\nimport AdminStore from \"../admin/AdminStore\";\r\n\r\nimport SidewalkActions from \"./SidewalkActions\";\r\nimport CommentsListComponent from \"./comments/CommentsListComponent\";\r\nimport SidewalkImageDetailsComponent from \"./images/SidewalkImageDetailsComponent\";\r\nimport PedestrianDataComponent from \"./PedestrianDataComponent\";\r\nimport SidewalkRatingsModal from \"./SidewalkRatingsModal\";\r\nimport {getRatingDescription} from \"../util/RatingUtil\";\r\nimport {CSVLink} from 'react-csv';\r\n\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\r\nimport Typography from '@material-ui/core/Typography';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\r\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport { FONT_FAMILY } from \"../constants/ThemeConstants\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport SpamUtil from \"../util/SpamUtil\";\r\n\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\twidth: '90%',\r\n\t},\r\n\t\r\n\theading: {\r\n\t\tfontSize: theme.typography.pxToRem(30),\r\n\t\tfontWeight: theme.typography.fontWeightRegular,\r\n\t\tfontFamily: FONT_FAMILY\r\n\t},\r\n});\r\n\r\n/**\r\n * This component handles rendering details about a selected sidewalk\r\n */\r\nclass SidewalkDetailsView extends Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tratingsModalOpen: false\r\n\t\t};\r\n\t\tthis.stores = [SidewalkStore, AdminStore];\r\n\t\tthis.selfRef = React.createRef();\r\n\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (this.props.visible && !prevProps.visible && this.props.selectedSidewalkDetails) {\r\n\t\t\tSidewalkActions.loadSidewalkDetails(this.props.selectedSidewalkDetails);\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Makes the call to prepare and download the clicked sidewalk's CSV data\r\n\t */\r\n\tgetCSVData = () => {\r\n\t\tSidewalkActions.downloadSidewalkCSV(this.state.currentSidewalk.id);\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * Handles closing of the drawer\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tthis.props.onClose();\r\n\t}\r\n\r\n\t/**\r\n\t * Handles a key being pressed\r\n\t * @param {Object} event - the event representing the key press\r\n\t */\r\n\t_handleKeyDown = (event) => {\r\n\t\tif (event.key === \"Escape\") {\r\n\t\t\tthis._handleClose();\r\n\t\t}\r\n\t};\r\n\r\n\r\n\trenderExpansionPanel(header, component, expanded = false) {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<ExpansionPanel defaultExpanded={expanded}>\r\n\t\t\t\t<ExpansionPanelSummary expandIcon={<ExpandMoreIcon />} data-sidewalk-header={header}>\r\n\t\t\t\t\t<Typography className={classes.heading}>{header}</Typography>\r\n\t\t\t\t</ExpansionPanelSummary>\r\n\t\t\t\t<ExpansionPanelDetails>\r\n\t\t\t\t\t{component}\r\n\t\t\t\t</ExpansionPanelDetails>\r\n\t\t\t</ExpansionPanel>\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Handles rendering summary details about this sidewalk\r\n\t */\r\n\trenderSummaryDetails() {\r\n\t\tlet imageSection = null;\r\n\t\tif (this.state.currentSidewalk.lastImage) {\r\n\t\t\timageSection = (\r\n\t\t\t\t<div className=\"drawerImageSection\">\r\n\t\t\t\t\t<img className=\"img-responsive\" alt=\"sidewalk-preview\" src={this.state.currentSidewalk.lastImage.url} />\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\timageSection = <h4>There are no uploaded images for this sidewalk.</h4>;\r\n\t\t}\r\n\r\n\t\tlet velocityText;\r\n\t\tif (this.state.currentSidewalk.averageVelocity > 0) {\r\n\t\t\tvelocityText = `The average pedestrian velocity on this sidewalk is ${this.state.currentSidewalk.averageVelocity} metres per second.;`;\r\n\t\t} else {\r\n\t\t\tvelocityText = \"No data has been recorded for the average pedestrian velocity of this sidewalk.\";\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<h3 className=\"streetNameSection\">\r\n\t\t\t\t\t{this.state.address}\r\n\t\t\t\t</h3>\r\n\t\t\t\t<hr />\r\n\t\t\t\t\t{imageSection}\r\n\t\t\t\t<hr />\r\n\t\t\t\t<h5>\r\n\t\t\t\t\t{velocityText}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{this.state.isLoggedIn && this.state.sidewalkHasCSVData && <CSVLink data={this.state.sidewalkCsvFormatted}>\r\n\t\t\t\t\t\t\t<Button bsStyle=\"primary\" className=\"sidewalkCsvButton\">\r\n\t\t\t\t\t\t\t\tExport CSV\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</CSVLink>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</h5>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\trenderUploadImageComponent() {\r\n\t\treturn <SidewalkImageDetailsComponent onOpenImages={this.props.onOpenImages} />;\r\n\t}\r\n\r\n\t_formatRating(value) {\r\n\t\treturn value ? getRatingDescription(value) : \"-\";\r\n\t}\r\n\r\n\t_openRatingsModal = () => {\r\n\t\tif (!SpamUtil.getCookie(\"timer\")){\r\n\t\t\tSpamUtil.deleteLocalStorage(\"NumberSidewalk\");\r\n\t\t}\r\n\t\tif (SpamUtil.getCookie(this.state.currentSidewalk.id)) {\r\n\t\t\tthis.setState({ ratingsModalOpen: false });\r\n\t\t\tSidewalkActions.suspendedSidewalk();\r\n\t\t} else if (SpamUtil.getCookie(\"timer\") === \"true\" && Number(SpamUtil.getLocalStorage(\"NumberSidewalk\")) + 1 > 3){\r\n\t\t\tthis.setState({ ratingsModalOpen: false });\r\n\t\t\tSidewalkActions.rateSuspendThirty();\r\n\t\t} else {\r\n\t\t\tthis.setState({ ratingsModalOpen: true });\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Closes the ratings modal\r\n\t * @param {boolean} postedRating - whether the user posted a rating to the sidewalk successfully or not\r\n\t */\r\n\t_closeRatingsModal = (postedRating) => {\r\n\t\tif (postedRating) {\r\n\t\t\tSidewalkActions.getSidewalkRatings(() => {this.props.updateRatings(this.state.currentSidewalk);});\r\n\t\t}\r\n\t\tthis.setState({ ratingsModalOpen: false });\r\n\t};\r\n\t\r\n\trenderRatingsAmount = () => {\r\n\t\tif (this.state.currentSidewalk.totalRatings === 1) {\r\n\t\t\treturn <h4>1 person has rated this sidewalk.</h4>\r\n\t\t}\r\n\t\treturn <h4>{this.state.currentSidewalk.totalRatings} people have rated this sidewalk.</h4>\r\n\t}\r\n\t\r\n\t/**\r\n\t * handles rendering the ratings on the drawer\r\n\t */\r\n\trenderRatings() {\r\n\t\treturn (\r\n\t\t\t<div >\r\n\t\t\t\t<Button bsStyle=\"primary\" onClick={this._openRatingsModal}>Rate this sidewalk</Button>\r\n\t\t\t\t<SidewalkRatingsModal open={this.state.ratingsModalOpen} onClose={this._closeRatingsModal} />\r\n\t\t\t\t{this.renderRatingsAmount()}\r\n\t\t\t\t<hr />\r\n\t\t\t\t<h4>Overall: {this._formatRating(this.state.currentSidewalk.overallRating)}</h4>\r\n\t\t\t\t<h4>Accessibility: {this._formatRating(this.state.currentSidewalk.accessibility)}</h4>\r\n\t\t\t\t<h4>Connectivity: {this._formatRating(this.state.currentSidewalk.connectivity)}</h4>\r\n\t\t\t\t<h4>Comfort: {this._formatRating(this.state.currentSidewalk.comfort)}</h4>\r\n\t\t\t\t<h4>Physical Safety: {this._formatRating(this.state.currentSidewalk.physicalSafety)}</h4>\r\n\t\t\t\t<h4>Sense of Security: {this._formatRating(this.state.currentSidewalk.senseOfSecurity)}</h4>\r\n\t\t\t</div >\r\n\t\t);\r\n\t}\r\n\r\n\trenderComments() {\r\n\t\treturn <CommentsListComponent />;\r\n\t}\r\n\r\n\r\n\trenderPedestrianData() {\r\n\t\tif (this.state.currentSidewalk.mobilityTypeDistribution.length === 0) {\r\n\t\t\treturn <h4>No pedestrian data has been recorded for this sidewalk</h4>;\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<PedestrianDataComponent activities={this.state.currentSidewalk.mobilityTypeDistribution} />\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * handles rendering the components on the drawer\r\n\t */\r\n\trenderDrawerDetails() {\r\n\t\tif (!this.state.currentSidewalk) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif (!this.state.sidewalkHasCSVData) {\r\n\t\t\tthis.getCSVData();\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div className=\"sidewalkDrawer\">\r\n\t\t\t\t{this.renderExpansionPanel(\"Summary\", this.renderSummaryDetails(), true)}\r\n\t\t\t\t{this.renderExpansionPanel(\"Images\", this.renderUploadImageComponent())}\r\n\t\t\t\t{this.renderExpansionPanel(\"Ratings\", this.renderRatings())}\r\n\t\t\t\t{this.renderExpansionPanel(\"Comments\", this.renderComments())}\r\n\t\t\t\t{this.renderExpansionPanel(\"Pedestrian Data\", this.renderPedestrianData())}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div tabIndex={0} onKeyDown={this._handleKeyDown} ref={this.selfRef} className=\"noOutlineDiv\">\r\n\t\t\t\t<Drawer open={this.props.visible}\r\n\t\t\t\t\t\tanchor=\"right\"\r\n\t\t\t\t\t\tvariant=\"temporary\"\r\n\t\t\t\t\t\tModalProps={{ onBackdropClick: this._handleClose }}\r\n\t\t\t\t\t\t>\t\r\n\t\t\t\t\t<div className=\"closeButton\">\r\n\t\t\t\t\t<CloseIcon onClick={this._handleClose}  />\r\n\t\t\t\t\t</div>\t\r\n\t\t\t\t\t{this.renderDrawerDetails()}\r\n\t\t\t\t</Drawer>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nexport default withStyles(styles)(SidewalkDetailsView);","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport LoaderComponent from \"../../misc-components/LoaderComponent\";\r\nimport ConfirmationModal from \"../../misc-components/ConfirmationModal\";\r\n\r\nimport Store from \"../../admin/AdminStore\";\r\nimport Actions from \"../../admin/AdminActions\";\r\n\r\n/**\r\n * This component renders a modal that allows an administrator to delete a user's image on a sidewalk\r\n */\r\nexport default class ImageDeletionModal extends Reflux.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.store = Store;\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the user closing the modal\r\n\t */\r\n\t_cancel = () => {\r\n\t\tthis.props.onClose();\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user selecting the confirm button\r\n\t */\r\n\t_confirm = () => {\r\n\t\tActions.deleteImage(this.props.sidewalkId, this.props.image.id, (success) => {\r\n\t\t\tif (success) {\r\n\t\t\t\tthis.props.onClose(true);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t\r\n\trenderModalBody() {\r\n\t\tif (!this.props.visible) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.isDeletingImage && <LoaderComponent />\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"selectedImagePreview\">\r\n\t\t\t\t\t<img className=\"img-responsive\"\r\n\t\t\t\t\t\talt=\"selected\"\r\n\t\t\t\t\t\tsrc={this.props.image.url} />\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ConfirmationModal title=\"Are you sure you want to delete this image?\"\r\n\t\t\t\t\t\t\t   body={this.renderModalBody()}\r\n\t\t\t\t\t\t\t   onCancel={this._cancel}\r\n\t\t\t\t\t\t\t   onConfirm={this._confirm}\r\n\t\t\t\t\t\t\t   visible={this.props.visible}\r\n\t\t\t\t\t\t\t   disabledConfirm={this.state.isDeletingImage}\r\n\t\t    />\r\n\t\t)\r\n\t}\r\n\r\n}\r\n","import React from \"react\";\r\n\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport ImageGallery from 'react-image-gallery';\r\n\r\nconst PAGE_SIZE = 10;\r\n\r\n/**\r\n * Renders an infinite amount of images\r\n */\r\nexport default class InfiniteImageGalleryCarousel extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t};\r\n\t\tthis.galleryRef = React.createRef();\r\n\t}\r\n\t\r\n\tgetCurrentIndex = () => {\r\n\t\treturn this.galleryRef.current.getCurrentIndex();\r\n\t};\r\n\t\r\n\t_onSelectionChanged = (newIndex) => {\r\n\t\tif (this.props.hasNextPage && !this.props.isNextPageLoading && (this.props.loadedImages.length - newIndex) < 4) {\r\n\t\t\tthis.props.loadMoreData(this.props.loadedImages.length, this.props.loadedImages.length + PAGE_SIZE);\r\n\t\t}\r\n\t};\r\n\t\r\n\t_onImageClicked = (index) => {\r\n\t\tthis.galleryRef.current.slideToIndex(index);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles a key being pressed\r\n\t * @param {Object} event - the event representing the key press\r\n\t */\r\n\t_handleKeyDown = (event) => {\r\n\t\tif (!this.props.visible) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (event.key === \"Escape\") {\r\n\t\t\tthis.props.onClose();\r\n\t\t}\r\n\t};\r\n\t\r\n\t_renderCustomControls = () => {\r\n\t\tif (!this.props.renderAboveImage) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div className=\"imageCarouselControls\">\r\n\t\t\t\t{this.props.renderAboveImage()}\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\t\r\n\trenderCarousel() {\r\n\t\tconst images = this.props.loadedImages.filter((item) => item).map((item) => {\r\n\t\t\treturn {\r\n\t\t\t\toriginal: item.url,\r\n\t\t\t\tthumbnail: item.url,\r\n\t\t\t\tsizes: \"800px\",\r\n\t\t\t\toriginalClass: \"img-responsive\"\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn (\r\n\t\t  <ImageGallery items={images}\r\n\t\t\t\t\t\tinfinite={false}\r\n\t\t\t\t\t\tlazyLoad\r\n\t\t\t\t\t\tshowPlayButton={false}\r\n\t\t\t\t\t\tref={this.galleryRef}\r\n\t\t\t\t\t\trenderCustomControls={this._renderCustomControls}\r\n\t\t\t\t\t\tonSlide={this._onSelectionChanged}\r\n\t\t\t\t\t\tthumbnailPosition=\"top\"\r\n\t\t\t\t\t\tshowFullscreenButton={false}\r\n\t\t  />\r\n\t\t);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tif (this.props.noDrawer) {\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"noOutlineDiv\" tabIndex={0} onKeyDown={this._handleKeyDown}>\r\n\t\t\t\t\t{this.renderCarousel()}\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className=\"noOutlineDiv\" tabIndex={0} onKeyDown={this._handleKeyDown}>\r\n\t\t\t\t<Drawer open={this.props.visible}\r\n\t\t\t\t\tvariant=\"persistent\"\r\n\t\t\t\t\tonClose={this.props.onClose}\r\n\t\t\t\t\tanchor=\"bottom\"\r\n\t\t\t\t\tSlideProps={{\r\n\t\t\t\t\t\tunmountOnExit: true\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\tpaper: \"fullscreenDrawer\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t{this.renderCarousel()}\r\n\t\t\t\t</Drawer>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport SidewalkStore from \"../SidewalkStore\";\r\nimport SidewalkActions from \"../SidewalkActions\";\r\nimport AdminStore from \"../../admin/AdminStore\";\r\nimport ImageDeletionModal from \"./ImageDeletionModal\";\r\nimport InfiniteImageGalleryCarousel from \"../../images/InfiniteImageGalleryCarousel.jsx\";\r\n\r\n/**\r\n * This component handles the view where the user can see all of the images posted to a sidewalk\r\n */\r\nexport default class SidewalkUploadedImagesGallery extends Reflux.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.stores = [SidewalkStore, AdminStore];\r\n\t\tthis.state = {\r\n\t\t\tmodalOpened: false\r\n\t\t};\r\n\t\tthis.galleryRef = React.createRef();\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (!prevProps.visible && this.props.visible && this.state.loadedUserImages.length < 2 && this.state.hasNextImagesPage) {\r\n\t\t\tthis._loadMoreImages(this.state.loadedUserImages.length, 10);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads more images to display\r\n\t * @param {number} startIndex - the starting index of new items to load\r\n\t * @param {number} stopIndex - the ending index of new items to load\r\n\t */\r\n\t_loadMoreImages = (startIndex, stopIndex) => {\r\n\t\tSidewalkActions.loadUploadedImages(startIndex, stopIndex);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the delete image button being clicked\r\n\t */\r\n\t_onDeleteImageClicked = (image) => {\r\n\t\tthis.setState({\r\n\t\t\tmodalOpened: true,\r\n\t\t\tselectedImage: image\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the modal asking the user to confirm their deletion attempt being closed\r\n\t * @param {boolean} deleted - whether the image was successfully deleted or not\r\n\t */\r\n\t_onModalClosed = (deleted) => {\r\n\t\tif (deleted) {\r\n\t\t\tSidewalkActions.removeLoadedImage(this.state.selectedImage, (index) => {\r\n\t\t\t\tthis.galleryRef.current._onImageClicked(index - 1);\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onClose();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tmodalOpened: false,\r\n\t\t\tselectedImage: null\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Renders the button allowing the user to delete the currently selected image\r\n\t * @return - null if the image is not selected, or the close button if the image is selected\r\n\t */\r\n\t_renderDeleteButton = () => {\r\n\t\tlet deleteIcon;\r\n\t\tif (!this.state.isLoggedIn) {\r\n\t\t\tdeleteIcon = null;\r\n\t\t} else {\r\n\t\t\tdeleteIcon = (\r\n\t\t\t\t<Grid item>\r\n\t\t\t\t\t<Tooltip title=\"Delete this image\">\r\n\t\t\t\t\t\t<Avatar className=\"imageDeleteAvatar\" onClick={() => {this._onDeleteImageClicked(this.state.loadedUserImages[this.galleryRef.current.getCurrentIndex()])}}>\r\n\t\t\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</Grid>\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<Grid container justify=\"space-between\" spacing={24} direction=\"row\" style={{\r\n\t\t\t\t\tflexGrow: 1,\r\n\t\t\t\t\tposition: \"fixed\"\r\n\t\t\t\t  }}>\r\n\t\t\t\t{deleteIcon}\r\n\t\t\t\t<Grid item>\r\n\t\t\t\t\t<Tooltip title=\"Exit the carousel\">\r\n\t\t\t\t\t\t<Avatar className=\"imageDeleteAvatar\" onClick={this.props.onClose} >\r\n\t\t\t\t\t\t\t<CloseIcon />\r\n\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t};\r\n\r\n\r\n\trender() {\r\n\t\tif (!this.state.currentSidewalk) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<InfiniteImageGalleryCarousel\r\n\t\t\t\t\tloadedImages={this.state.loadedUserImages}\r\n\t\t\t\t\thasNextPage={this.state.hasNextImagesPage}\r\n\t\t\t\t\tloadMoreData={this._loadMoreImages}\r\n\t\t\t\t\tvisible={this.props.visible}\r\n\t\t\t\t\tisNextPageLoading={this.state.isNextImagePageLoading}\r\n\t\t\t\t\tonClose={this.props.onClose}\r\n\t\t\t\t\trenderAboveImage={this._renderDeleteButton}\r\n\t\t\t\t\tref={this.galleryRef}\r\n\t\t\t\t/>\r\n\t\t\t\t<ImageDeletionModal visible={this.props.visible && this.state.modalOpened}\r\n\t\t\t\t\t\t\t\t\tonClose={this._onModalClosed}\r\n\t\t\t\t\t\t\t\t\tsidewalkId={this.state.currentSidewalk.id}\r\n\t\t\t\t\t\t\t\t\timage={this.state.selectedImage} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\n\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport SnackbarContent from \"@material-ui/core/SnackbarContent\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\n\r\n/**\r\n * This component renders a temporary message to the user that will disappear after a few seconds\r\n */\r\nexport default class BaseAlertComponent extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {}\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tthis.props.onClose();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Snackbar\r\n\t\t\t  anchorOrigin={{\r\n\t\t\t\tvertical: \"bottom\",\r\n\t\t\t\thorizontal: \"left\",\r\n\t\t\t  }}\r\n\t\t\t  open={this.props.visible}\r\n\t\t\t  autoHideDuration={4000}\r\n\t\t\t  onClose={this._handleClose}\r\n\t\t\t>\r\n\t\t\t\t<SnackbarContent\r\n\t\t\t\t  className={this.props.alertContentClassName}\r\n\t\t\t\t  aria-describedby=\"client-snackbar\"\r\n\t\t\t\t  message={\r\n\t\t\t\t\t<div id=\"client-snackbar\" className=\"alertBody\">\r\n\t\t\t\t\t\t{this.props.icon}\r\n\t\t\t\t\t  <span className=\"alertMessage\">\r\n\t\t\t\t\t\t  {this.props.message}\r\n\t\t\t\t\t  </span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t  }\r\n\t\t\t\t  action={this.props.hideClose ? undefined : [\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t  key=\"close\"\r\n\t\t\t\t\t  aria-label=\"Close\"\r\n\t\t\t\t\t  color=\"inherit\"\r\n\t\t\t\t\t  onClick={this._handleClose}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  <CloseIcon />\r\n\t\t\t\t\t</IconButton>,\r\n\t\t\t\t  ]}\r\n\t\t\t\t/>\r\n\t\t\t</Snackbar>\r\n\t\t)\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport ErrorIcon from \"@material-ui/icons/Error\";\r\n\r\nimport BaseAlertComponent from \"./BaseAlertComponent\";\r\n\r\n/**\r\n * This component renders an error message to the user that will disappear after a few seconds\r\n */\r\nexport default class ErrorAlertComponent extends React.Component {\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<BaseAlertComponent {...this.props}\r\n\t\t\t\t\t\t\t\talertContentClassName=\"errorAlert\"\r\n\t\t\t\t\t\t\t\ticon={<ErrorIcon className=\"alertIcon\" />}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../SidewalkStore\";\r\nimport Actions from \"../SidewalkActions\";\r\nimport ErrorAlertComponent from \"../../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when an image upload fails\r\n */\r\nexport default class UploadedImageErrorComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissImageErrorMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.uploadedImageError}\r\n\t\t\t\t\t\t\t\t message=\"An error occurred while uploading the image.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport CheckCircleIcon from \"@material-ui/icons/CheckCircle\";\r\n\r\nimport BaseAlertComponent from \"./BaseAlertComponent\";\r\n\r\n/**\r\n * This component renders a successful action message to the user that will disappear after a few seconds\r\n */\r\nexport default class SuccessAlertComponent extends React.Component {\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<BaseAlertComponent onClose={this.props.onClose}\r\n\t\t\t\t\t\t\t\tvisible={this.props.visible}\r\n\t\t\t\t\t\t\t\tmessage={this.props.message}\r\n\t\t\t\t\t\t\t\talertContentClassName=\"successAlert\"\r\n\t\t\t\t\t\t\t\ticon={<CheckCircleIcon className=\"alertIcon\" />}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../SidewalkStore\";\r\nimport Actions from \"../SidewalkActions\";\r\nimport SuccessAlertComponent from \"../../misc-components/SuccessAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when an image upload succeeds\r\n */\r\nexport default class UploadedImageSuccessComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissImageSuccessMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SuccessAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.uploadImageSucceeded}\r\n\t\t\t\t\t\t\t\t message=\"Your image was uploaded. It must be approved before it is visible.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../../admin/AdminStore\";\r\nimport Actions from \"../../admin/AdminActions\";\r\nimport SuccessAlertComponent from \"../../misc-components/SuccessAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when a comment delete attempt succeeds\r\n */\r\nexport default class CommentDeleteSuccessComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissCommentSuccessMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SuccessAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.successfullyDeletedComment}\r\n\t\t\t\t\t\t\t\t message=\"The comment was successfully deleted.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../../admin/AdminStore\";\r\nimport Actions from \"../../admin/AdminActions\";\r\nimport ErrorAlertComponent from \"../../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when a comment delete attempt fails\r\n */\r\nexport default class CommentDeleteErrorComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissCommentErrorMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.failedDeleteComment}\r\n\t\t\t\t\t\t\t\t message=\"An error occurred while deleting the comment.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../../admin/AdminStore\";\r\nimport Actions from \"../../admin/AdminActions\";\r\nimport ErrorAlertComponent from \"../../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when an image deletion fails\r\n */\r\nexport default class ImageDeleteErrorComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissImageErrorMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.failedDeleteImage}\r\n\t\t\t\t\t\t\t\t message=\"An error occurred while deleting the image.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../../admin/AdminStore\";\r\nimport Actions from \"../../admin/AdminActions\";\r\nimport SuccessAlertComponent from \"../../misc-components/SuccessAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when an image deletion succeeds\r\n */\r\nexport default class ImageDeleteSuccessComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissImageSuccessMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SuccessAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.successfullyDeletedImage}\r\n\t\t\t\t\t\t\t\t message=\"The image has been successfully deleted.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../SidewalkStore\";\r\nimport Actions from \"../SidewalkActions\";\r\nimport SuccessAlertComponent from \"../../misc-components/SuccessAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when a comment post attempt succeeds\r\n */\r\nexport default class CommentPostSuccessComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissCommentSuccessMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SuccessAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.uploadCommentSucceeded}\r\n\t\t\t\t\t\t\t\t message=\"Your comment was successfully posted.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../SidewalkStore\";\r\nimport Actions from \"../SidewalkActions\";\r\nimport ErrorAlertComponent from \"../../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when a comment post attempt fails\r\n */\r\nexport default class CommentPostErrorComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissCommentErrorMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.uploadCommentFailed}\r\n\t\t\t\t\t\t\t\t message=\"An error occurred while posting the comment.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"./SidewalkStore\";\r\nimport Actions from \"./SidewalkActions\";\r\nimport SuccessAlertComponent from \"../misc-components/SuccessAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when a rating post attempt succeeds\r\n */\r\nexport default class PostRatingSuccessComonent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissRatingsSuccessMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<SuccessAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.successfullyUploadedRatings}\r\n\t\t\t\t\t\t\t\t message=\"Your rating was successfully posted.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"./SidewalkStore\";\r\nimport Actions from \"./SidewalkActions\";\r\nimport ErrorAlertComponent from \"../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when a rating post attempt fails\r\n */\r\nexport default class PostRatingErrorComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissRatingsFailureMessage();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.failedUploadingRatings}\r\n\t\t\t\t\t\t\t\t message=\"An error occurred while posting the rating.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"./SidewalkStore\";\r\nimport Actions from \"./SidewalkActions\";\r\nimport ErrorAlertComponent from \"../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when the user posts too many ratings to the same sidewalk\r\n * in a short amount of time\r\n */\r\nexport default class PostRatingSameSidewalk extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissSuspendSidewalk();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.sameSidewalkRatingError}\r\n\t\t\t\t\t\t\t\t message=\"You can only rate the same sidewalk once per hour.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"./SidewalkStore\";\r\nimport Actions from \"./SidewalkActions\";\r\nimport ErrorAlertComponent from \"../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when the user posts too many ratings within 30 seconds\r\n */\r\nexport default class PostRatingThirtyComponent extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissRateSuspendThirty();\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.thirtySecondRatingError}\r\n\t\t\t\t\t\t\t\t message=\"You have rated too many sidewalks within 30 seconds.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../SidewalkStore\";\r\nimport Actions from \"../SidewalkActions\";\r\nimport ErrorAlertComponent from \"../../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component renders the error message that is displayed when a comment post attempt fails\r\n */\r\nexport default class PostCommentingSameSidewalk extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissSuspendSidewalkComment();\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.commentOneSidewalk}\r\n\t\t\t\t\t\t\t\t message=\"You can't comment on the same sidewalk more than 3 times a day.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Store from \"../SidewalkStore\";\r\nimport Actions from \"../SidewalkActions\";\r\nimport ErrorAlertComponent from \"../../misc-components/ErrorAlertComponent\";\r\n/**\r\n * This component renders the error message that is displayed when attempt comment failed\r\n */\r\nexport default class PostCommentingThirtySidewalk extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.store = Store;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n\t\tActions.dismissCommentSuspendThirty();\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.thirtyCommentSuspend}\r\n\t\t\t\t\t\t\t\t message=\"You can comment at most 3 times in 30 seconds.\"\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\n\r\nimport UploadedImageErrorComponent from \"../sidewalk/images/UploadedImageErrorComponent\";\r\nimport UploadedImageSuccessComponent from \"../sidewalk/images/UploadedImageSuccessComponent\";\r\nimport CommentDeleteSuccessComponent from \"../sidewalk/comments/CommentDeleteSuccessComponent\";\r\nimport CommentDeleteErrorComponent from \"../sidewalk/comments/CommentDeleteErrorComponent\";\r\nimport ImageDeleteErrorComponent from \"../sidewalk/images/ImageDeleteErrorComponent\";\r\nimport ImageDeleteSuccessComponent from \"../sidewalk/images/ImageDeleteSuccessComponent\";\r\nimport CommentPostSuccessComponent from \"../sidewalk/comments/CommentPostSuccessComponent\";\r\nimport CommentPostErrorComponent from \"../sidewalk/comments/CommentPostErrorComponent\";\r\nimport PostRatingSuccessComponent from \"../sidewalk/PostRatingSuccessComponent\";\r\nimport PostRatingErrorComponent from \"../sidewalk/PostRatingErrorComponent\";\r\nimport PostRatingSameSidewalk from \"../sidewalk/PostRatingSameSidewalk\";\r\nimport PostRatingThirtyComponent from \"../sidewalk/PostRatingThirtyComponent\";\r\nimport PostCommentingSameSidewalk from \"../sidewalk/comments/PostCommentingSameSidewalk\";\r\nimport PostCommentingThirtySidewalk from \"../sidewalk/comments/PostCommentingThirtyComponent\";\r\n\r\n\r\n\r\n\r\n/**\r\n * Renders any alerts that the user may see\r\n */\r\nexport default class AlertsContainer extends React.Component {\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<UploadedImageErrorComponent />\r\n\t\t\t\t<UploadedImageSuccessComponent />\r\n\t\t\t\t<CommentDeleteSuccessComponent />\r\n\t\t\t\t<CommentDeleteErrorComponent />\r\n\t\t\t\t<ImageDeleteErrorComponent />\r\n\t\t\t\t<ImageDeleteSuccessComponent />\r\n\t\t\t\t<CommentPostErrorComponent />\r\n\t\t\t\t<CommentPostSuccessComponent />\r\n\t\t\t\t<PostRatingSuccessComponent />\r\n\t\t\t\t<PostRatingErrorComponent />\r\n\t\t\t\t<PostRatingSameSidewalk/>\r\n\t\t\t\t<PostRatingThirtyComponent/>\r\n\t\t\t\t<PostCommentingSameSidewalk/>\r\n\t\t\t\t<PostCommentingThirtySidewalk/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n}","import React from \"react\";\r\nimport { Component } from 'reflux';\r\n\r\nimport SummaryMapView from \"./SummaryMapView\";\r\nimport SidewalkDetailsView from \"../sidewalk/SidewalkDetailsView\";\r\nimport SidewalkUploadedImagesGallery from \"../sidewalk/images/SidewalkUploadedImagesGallery\";\r\nimport AlertsContainer from \"./AlertsContainer\";\r\n\r\nimport MapStore from \"./MapStore\";\r\nimport MapActions from \"./MapActions\";\r\n\r\nexport default class MapDashboard extends Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tviewingImages: false\r\n\t\t};\r\n\t\tthis.store = MapStore;\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (!this.state.sidewalks || this.state.sidewalks.length === 0) {\r\n\t\t\tMapActions.loadAllSidewalks();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Opens up the uploaded images view\r\n\t */\r\n\t_viewImages = () => {\r\n\t\tMapActions.setDrawerOpened(false);\r\n\t\tthis.setState({\r\n\t\t\tviewingImages: true\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Closes the uploaded images view\r\n\t * @param {boolean} reopenDrawer - whether the drawer should be reopened or not\r\n\t */\r\n\t_closeImages = (reopenDrawer = true) => {\r\n\t\tif (reopenDrawer) {\r\n\t\t\tMapActions.setDrawerOpened(true);\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tviewingImages: false\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * Updates the ratings of the currently selected sidewalk in the list of all sidewalks\r\n\t * @param {Object} sidewalk - details about the sidewalk\r\n\t */\r\n\t_updateRatings = (sidewalk) => {\r\n\t\tMapActions.updateSidewalkRatings(sidewalk);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user closing the drawer\r\n\t */\r\n\t_onCloseDrawer = () => {\r\n\t\tthis._closeImages(false);\r\n\t\tMapActions.setDrawerOpened(false);\r\n\t};\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<SummaryMapView />\r\n\t\t\t\t<SidewalkDetailsView\r\n\t\t\t\t\tvisible={this.state.sidewalkSelected}\r\n\t\t\t\t\tonClose={this._onCloseDrawer}\r\n\t\t\t\t\tselectedSidewalkDetails={this.state.selectedSidewalkDetails}\r\n\t\t\t\t\tonOpenImages={this._viewImages}\r\n\t\t\t\t\tupdateRatings={this._updateRatings}\r\n\t\t\t\t/>\r\n\t\t\t\t<SidewalkUploadedImagesGallery onClose={this._closeImages} visible={this.state.viewingImages} />\r\n\t\t\t\t<AlertsContainer />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}","import React from \"react\";\r\n\r\n/**\r\n * This component renders the page that details what the site is about\r\n */\r\nexport default class AboutPageView extends React.Component {\r\n\r\n\t/**\r\n\t * Renders a topic in the about page\r\n\t * @param {String} title - the title of the topic\r\n\t * @param {String} content - the content describing the topic\r\n\t */\r\n\trenderCategory(title, content) {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<h3>{title}</h3>\r\n\t\t\t\t<p>{content}</p>\r\n\t\t\t\t<hr />\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"padding25\">\r\n\t\t\t\t{this.renderCategory(\"About Us\", \r\n\t\t\t\t\t`Steps is a research platform by Space and Culture Research Group, aimed at developing a participatory approach to assess walkability.\r\n\t\t\t\t\tSteps web-app is a tool by Space and Culture and Sid Six for collecting perceptions and feedback on walkability. \r\n\t\t\t\t\tEdmonton residents and visitors can use this map to share their thoughts about the \r\n\t\t\t\t\tpedestrian network or explore the data collected to date. This information will help identify gaps in pedestrian infrastructure and build the case for improvements.\r\n\t\t\t\t\t`)}\r\n\t\t\t\t{this.renderCategory(\"Instructions\", `\r\n\t\t\t\t\tClick on any sidewalk to add data. You can upload pictures, make comments and rate different aspects of walkability. Your information will be stored in the segment that you selected.\r\n\t\t\t\t\tThe information collected by this app in entirely anonymous. Pictures and comments will be subject to admin approval.\r\n\t\t\t\t`)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport CheckCircleIcon from \"@material-ui/icons/CheckCircle\";\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport AdminStore from \"./AdminStore\";\r\nimport AdminActions from \"./AdminActions\";\r\nimport InfiniteImageGalleryCarousel from \"../images/InfiniteImageGalleryCarousel.jsx\";\r\nimport SuccessAlertComponent from \"../misc-components/SuccessAlertComponent\";\r\nimport ErrorAlertComponent from \"../misc-components/ErrorAlertComponent\";\r\n\r\n/**\r\n * This component handles the view where administrators can approve/reject images uploaded to sidewalks\r\n */\r\nexport default class PendingImagesGallery extends Reflux.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.store = AdminStore;\r\n\t\tthis.state = {};\r\n\t\tthis.galleryRef = React.createRef();\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.state.pendingImages.length === 0) {\r\n\t\t\tthis._loadMoreImages(0, 10);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads more images to display\r\n\t * @param {number} startIndex - the starting index of new items to load\r\n\t * @param {number} stopIndex - the ending index of new items to load\r\n\t */\r\n\t_loadMoreImages = (startIndex, stopIndex) => {\r\n\t\tAdminActions.getUnapprovedImages(startIndex, stopIndex);\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user approving an image\r\n\t * @param {Object} image - the image to approve\r\n\t */\r\n    _onAcceptImage = (image) => {\r\n\t\tif (this.state.respondingToImage) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tAdminActions.handlePendingImages(true, image.id, image.sidewalk.id, (index) => {\r\n\t\t\tthis.galleryRef.current._onImageClicked(index - 1);\r\n\t\t});\r\n    }\r\n\r\n\t/**\r\n\t * Handles the user rejecting an image\r\n\t * @param {Object} image - the image to reject\r\n\t */\r\n    _onRejectImage = (image) => {\r\n\t\tif (this.state.respondingToImage) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tAdminActions.handlePendingImages(false, image.id, image.sidewalk.id, (index) => {\r\n\t\t\tthis.galleryRef.current._onImageClicked(index - 1);\r\n\t\t});\r\n    }\r\n\r\n\t/**\r\n\t * Renders the approve and reject buttons for the selected image\r\n\t * @return {JSX} - the buttons if the image is selected\r\n\t */\r\n\t_renderResponseButtons = () => {\r\n\t\treturn (\r\n\t\t\t <Grid container>\r\n\t\t\t\t<Grid item>\r\n\t\t\t\t\t<Tooltip title=\"Reject this image\">\r\n\t\t\t\t\t\t<Avatar className=\"imageDeleteAvatar\" onClick={() => {this._onRejectImage(this.state.pendingImages[this.galleryRef.current.getCurrentIndex()])}}>\r\n\t\t\t\t\t\t\t<CloseIcon />\r\n\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item>\r\n\t\t\t\t\t<Tooltip title=\"Approve this image\">\r\n\t\t\t\t\t\t<Avatar className=\"imageApproveAvatar\" onClick={() => {this._onAcceptImage(this.state.pendingImages[this.galleryRef.current.getCurrentIndex()])}}>\r\n\t\t\t\t\t\t\t<CheckCircleIcon />\r\n\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t};\r\n\t\r\n\t_dismissNotifications = () => {\r\n\t\tAdminActions.dismissImageApprovalNotification();\r\n\t\tAdminActions.dismissImageRejectionNotification();\r\n\t};\r\n\r\n\trender() {\r\n\t\tif (this.state.pendingImages.length === 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<InfiniteImageGalleryCarousel\r\n\t\t\t\t\tloadedImages={this.state.pendingImages}\r\n\t\t\t\t\thasNextPage={this.state.hasMoreImages}\r\n\t\t\t\t\tloadMoreData={this._loadMoreImages}\r\n\t\t\t\t\tvisible={this.state.pendingImages.length > 0}\r\n\t\t\t\t\tisNextPageLoading={this.state.isNextPageLoading}\r\n\t\t\t\t\tonClose={() => {}}\r\n\t\t\t\t\trenderAboveImage={this._renderResponseButtons}\r\n\t\t\t\t\tref={this.galleryRef}\r\n\t\t\t\t\tnoDrawer\r\n\t\t\t\t/>\r\n\t\t\t\t<SuccessAlertComponent onClose={this._dismissNotifications}\r\n\t\t\t\t\t\t visible={this.state.successfullyRespondedToImage}\r\n\t\t\t\t\t\t message=\"Your response has been recorded.\"\r\n\t\t\t\t/>\r\n\t\t\t\t<ErrorAlertComponent onClose={this._dismissNotifications}\r\n\t\t\t\t\t\t visible={this.state.failedToRespondToImage}\r\n\t\t\t\t\t\t message=\"An error occurred while recording your response.\"\r\n\t\t\t\t/> \r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport AdminStore from \"./AdminStore\";\r\nimport PendingImagesGallery from \"./PendingImagesGallery\";\r\n\r\n/**\r\n * This component renders the gallery of all uploaded images that have yet to be approved or rejected\r\n */\r\nexport default class AdminDrawerImageGallery extends Reflux.Component {\r\n\t\r\n    constructor(props) {\r\n        super(props);\r\n        this.store = AdminStore;\r\n        this.state = {};\r\n\t}\r\n    \r\n    componentDidMount() {\r\n\t\tif (!this.state.isLoggedIn) {\r\n\t\t\tthis.props.history.push('/login');\r\n\t\t}\r\n    }\r\n    \r\n\trender() {\r\n\t\tif (!this.state.isLoggedIn) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst pendingImages = this.state.pendingImages,\r\n\t\t\tshowAdminImages = !(pendingImages.length === 0);\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t{!showAdminImages && <h3 className=\"adminPanelEmptyText\"> There are no images to approve or reject.</h3>}\r\n\t\t\t\t<PendingImagesGallery />\r\n\t\t\t</div>\r\n\r\n\t\t);\r\n    }\r\n}","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport {Link} from \"react-router-dom\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {SECONDARY_COLOUR, FONT_FAMILY} from \"../constants/ThemeConstants\";\r\nimport SpamUtil from \"../util/SpamUtil\";\r\nimport AdminStore from \"../admin/AdminStore\";\r\nimport AdminActions from \"../admin/AdminActions\";\r\n\r\nconst styles = {\r\n\troot: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginLeft: -12,\r\n\t\tmarginRight: 20,\r\n\t},\r\n\tbutton: {\r\n\t\tfontSize: 14,\r\n\t\t\"&:hover\": {\r\n\t\t\tcolor: SECONDARY_COLOUR\r\n\t\t},\r\n\t\t\"&:focus\": {\r\n\t\t\tcolor: SECONDARY_COLOUR\r\n\t\t},\r\n\t\tcolor: \"white\"\r\n\t},\r\n\ttitleButton: {\r\n\t\tfontSize: 18,\r\n\t\t\"&:hover\": {\r\n\t\t\tcolor: SECONDARY_COLOUR\r\n\t\t},\r\n\t\t\"&:focus\": {\r\n\t\t\tcolor: SECONDARY_COLOUR\r\n\t\t},\r\n\t\tcolor: \"white\",\r\n\t\tfontFamily: FONT_FAMILY\r\n\t}\r\n};\r\n\r\n/**\r\n * This component renders the global navigation bar at the top of the page\r\n */\r\nclass NavbarComponent extends Reflux.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.store = AdminStore;\r\n\t}\r\n\r\n\t/**\r\n\t * Handles the user logging out of the application\r\n\t */\r\n\t_logout = () => {\r\n\t\tAdminActions.logoutAdmin();\r\n\t\tSpamUtil.deleteCookie(\"User\");\r\n\t\tSpamUtil.deleteLocalStorage(\"LoginAttempts\");\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.root}>\r\n\t\t\t\t<AppBar position=\"static\">\r\n\t\t\t\t\t<Toolbar>\r\n\t\t\t\t\t\t<Link to=\"/\"><Button color=\"inherit\" className={classes.titleButton}>STEPS </Button> </Link>\r\n\t\t\t\t\t\t<Link to=\"/about/\"><Button color=\"inherit\" className={classes.button}>  About </Button></Link>\r\n\t\t\t\t\t\t<Link to=\"/statistics/\"><Button color=\"inherit\" className={classes.button}> <Link to=\"/statistics/\"/> Statistics </Button></Link>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.state.isLoggedIn && <Link to=\"/dashboard\"><Button color=\"inherit\" className={classes.button}>  Dashboard</Button></Link>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.state.isLoggedIn && <Button color=\"inherit\" onClick={this._logout} className={classes.button}>Logout</Button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t</AppBar>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(NavbarComponent);","import React from \"react\";\r\nimport { Component } from \"reflux\";\r\nimport md5 from \"md5\";\r\nimport { Button, FormGroup, FormControl, ControlLabel } from \"react-bootstrap\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\n\r\nimport AdminActions from \"./AdminActions\";\r\nimport Store from \"./AdminStore\";\r\n\r\nimport SuccessAlertComponent from \"../misc-components/SuccessAlertComponent\";\r\nimport ErrorAlertComponent from \"../misc-components/ErrorAlertComponent\";\r\nimport SpamUtil from \"../util/SpamUtil\";\r\nimport {LOCAL_STORAGE_NAME, SUSPENSION_COOKIE, COOKIE_EXPIRE_TIME, MAX_LOGIN_ATTEMPTS} from \"../constants/AdminConstants\";\r\n\r\n/**\r\n * This component renders the page for admin Login\r\n */\r\nexport default class AdminLogin extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.store = Store;\r\n\t\tthis.state = {\r\n            enteredName: \"\",\r\n\t\t\tenteredPassword: \"\"\r\n        };\r\n\t}\r\n\t\r\n\tcomponentWillUpdate() {\r\n\t\tif (this.state.isLoggedIn) {\r\n\t\t\tthis.props.history.push('/dashboard');\r\n        }\r\n\t}\r\n\t\r\n    /**\r\n\t * Handles the user changing their username text value\r\n\t */\r\n\t_handleUserChange = (e) => {\r\n\t\tthis.setState({ \r\n            enteredName: e.target.value,\r\n\t\t});\r\n    }\r\n    \r\n    /**\r\n\t * Handles the user changing their password text value\r\n\t */\r\n    _handlePassChange = (e) => {\r\n\t\tthis.setState({ \r\n            enteredPassword: e.target.value\r\n\t\t});\r\n\t}\r\n\r\n\t_validateCredentials = () => {\r\n\t\tif (this.state.enteredName.length > 0 && this.state.enteredPassword.length > 0) {\r\n\t\t\treturn !Boolean(SpamUtil.getCookie(SUSPENSION_COOKIE));\r\n\t\t}\r\n\t\treturn false;\r\n    }\r\n\r\n\t/**\r\n\t * Checks if the credentials entered by the user are correct\r\n\t * If not enter correct credential first time storage is implemented\r\n\t * If user enters Credentials incorrectly 4 times then they are suspended. Cookie is created during this time.\r\n\t */\r\n\t_handleSubmit = () => {\r\n\t\tconst attempts = Number(SpamUtil.getLocalStorage(LOCAL_STORAGE_NAME));\r\n\t\tif (isNaN(attempts) || attempts < MAX_LOGIN_ATTEMPTS + 1) {\r\n\t\t\tAdminActions.checkCredentials(this.state.enteredName, md5(this.state.enteredPassword));\r\n\t\t} else {\r\n\t\t\tSpamUtil.setCookie(SUSPENSION_COOKIE, \"true\", COOKIE_EXPIRE_TIME, \"login\");\r\n\t\t\tSpamUtil.deleteLocalStorage(LOCAL_STORAGE_NAME)\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n            enteredName: \"\",\r\n            enteredPassword: \"\"\r\n\t\t});\r\n\t}\r\n\r\n    /**\r\n\t * Handles the component being closed\r\n\t */\r\n\t_handleClose = () => {\r\n        AdminActions.dismissLoginSuccess();\r\n        AdminActions.dismissLoginError();\r\n\t};\r\n\r\n    render(){\r\n        return (\r\n\t\t\t<div className=\"LoginCSS\">\r\n            <div className=\"loginContainer\" data-admin-login={true}>\r\n\t\t\t\t<Card>\r\n\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t<h3 className=\"adminTitleLogin\">Admin Login</h3>\r\n\t\t\t\t\t\t<FormGroup \r\n\t\t\t\t\t\t\tcontrolId=\"username\" \r\n\t\t\t\t\t\t\tbsSize=\"small\">\r\n\t\t\t\t\t\t\t<ControlLabel>Username</ControlLabel>\r\n\t\t\t\t\t\t\t<FormControl \r\n\t\t\t\t\t\t\t\tautoFocus type=\"username\" \r\n\t\t\t\t\t\t\t\tvalue={this.state.enteredName}\r\n\t\t\t\t\t\t\t\tonChange={this._handleUserChange}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Username\"/>\r\n\t\t\t\t\t\t</FormGroup>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<FormGroup \r\n\t\t\t\t\t\t\tcontrolId=\"password\" \r\n\t\t\t\t\t\t\tbsSize=\"small\">\r\n\t\t\t\t\t\t\t<ControlLabel>Password</ControlLabel>\r\n\t\t\t\t\t\t\t<FormControl \r\n\t\t\t\t\t\t\t\tvalue={this.state.enteredPassword} \r\n\t\t\t\t\t\t\t\tonChange={this._handlePassChange}\r\n\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Password\"/>\r\n\t\t\t\t\t\t</FormGroup> \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<Button bsStyle=\"primary\" type=\"submit\" onClick = {this._handleSubmit} disabled={!this._validateCredentials()}>Login</Button>\r\n\t\t\t\t\t</CardContent>\r\n\t\t\t\t</Card>\r\n                \r\n                <SuccessAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.successfullyLoggedIn}\r\n\t\t\t\t\t\t\t\t message=\"You have successfully been logged in.\"/>\r\n                <ErrorAlertComponent onClose={this._handleClose}\r\n\t\t\t\t\t\t\t\t visible={this.state.failedToLogIn}\r\n\t\t\t\t\t\t\t\t message=\"You have entered an incorrect username or password.\"/>\r\n\t\t\t\t<ErrorAlertComponent onClose={() => {}}\r\n\t\t\t\t\t\t\t\t visible={SpamUtil.getCookie(\"Suspended\")}\r\n\t\t\t\t\t\t\t\t hideClose\r\n\t\t\t\t\t\t\t\t message=\"You have tried to log in unsuccessfully too many times. Try again in a minute.\"/>\r\n            </div>\r\n\t\t\t</div>\r\n        )\r\n    }\r\n}","import Reflux from \"reflux\";\r\n\r\nconst Actions = Reflux.createActions([\r\n\t\"loadSummaryStatistics\"\r\n]);\r\n\r\nexport default Actions;","import Reflux from \"reflux\";\r\n\r\nimport Actions from \"./SummaryStatisticsActions\";\r\nimport RestUtil from \"../util/RestUtil\";\r\n\r\n/**\r\n * This store keeps track of the state of components that render information related to sidewalk summary statistics\r\n */\r\nexport default class SummaryStatisticsStore extends Reflux.Store {\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {};\r\n\t\tthis.listenables = Actions;\r\n\t\t\r\n\t\tif (process.env.NODE_ENV === \"development\"){\r\n\t\t\twindow.DEV_STATISTICS_STORE = this;\r\n\t\t}\r\n\t}\r\n\r\n\tonLoadSummaryStatistics() {\r\n\t\tthis.setState({\r\n\t\t\tisLoading: true\r\n\t\t});\r\n\t\tPromise.all([RestUtil.sendGetRequest(\"sidewalk/summary\"), RestUtil.sendGetRequest(`sidewalk/completeSummary`)])\r\n\t\t\t.then((res) => {\r\n\t\t\t\tconst allSidewalkObjects = res[1];\r\n\t\t\t\tres = res[0];\r\n\t\t\t\tres.isLoading = false;\r\n\t\t\t\tres.contributionsByMonth.sort((a, b) => {\r\n\t\t\t\t\tconst aSplit = a.monthYear.split(\"/\"),\r\n\t\t\t\t\t\taMonth = parseInt(aSplit[0]),\r\n\t\t\t\t\t\taYear = parseInt(aSplit[1]);\r\n\t\t\t\t\tconst bSplit = b.monthYear.split(\"/\"),\r\n\t\t\t\t\t\tbMonth = parseInt(bSplit[0]),\r\n\t\t\t\t\t\tbYear = parseInt(bSplit[1]);\r\n\t\t\t\t\tif (aYear === bYear) {\r\n\t\t\t\t\t\treturn aMonth - bMonth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn aYear - bYear;\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tconst allSidewalkArray = [];\r\n\t\t\t\tallSidewalkArray.push(['SidewalkId', 'AccessibilityRating', 'Comfort', 'Connectivity', 'SenseOfSecurity', 'PhysicalSafety', 'OverallRating', 'TotalRatings', 'TotalComments', 'TotalImages']);\r\n\t\t\t\tallSidewalkObjects.sidewalks.forEach((sidewalk) => {\r\n\t\t\t\t\tconst data = [sidewalk.id, sidewalk.accessibility, sidewalk.comfort, sidewalk.connectivity, sidewalk.senseOfSecurity, sidewalk.physicalSafety, sidewalk.overallRating, sidewalk.ratings, sidewalk.comments, sidewalk.images];\r\n\t\t\t\t\tallSidewalkArray.push(data);\r\n\t\t\t\t});\r\n\t\t\t\tres.sidewalkSummary = allSidewalkObjects;\r\n\t\t\t\tres.csvFormatted = allSidewalkArray;\r\n\t\t\t\tthis.setState(res);\r\n\t\t\t}).catch((err) => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tisLoading: false\r\n\t\t\t\t});\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t});\r\n\t}\r\n\t\r\n}\r\n","import React from \"react\";\r\nimport Reflux from \"reflux\";\r\n\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Radio from '@material-ui/core/Radio';\r\nimport {BootstrapTable, TableHeaderColumn} from \"react-bootstrap-table\";\r\nimport {Line} from \"react-chartjs-2\";\r\n\r\nimport \"react-bootstrap-table/dist/react-bootstrap-table-all.min.css\";\r\n\r\nimport Store from \"./SummaryStatisticsStore\";\r\nimport Actions from \"./SummaryStatisticsActions\";\r\nimport DateUtilities from \"../util/DateUtilities\";\r\nimport LoaderComponent from \"../misc-components/LoaderComponent\";\r\nimport AdminStore from \"../admin/AdminStore\";\r\n\r\nimport {CSVLink} from 'react-csv';\r\nimport { Button } from \"react-bootstrap\"\r\n\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\n\r\nimport {getRatingDescription} from \"../util/RatingUtil\";\r\n\r\nconst round = (cell) => {\r\n\treturn cell.toFixed(2);\r\n};\r\n\r\n/**\r\n * Renders summary statistics across all sidewalks\r\n */\r\nexport default class SummaryStatisticsView extends Reflux.Component {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.stores = [Store, AdminStore];\r\n\t\tthis.state = {\r\n\t\t\tselectedTab: 0,\r\n\t\t\ttextDescription: true\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tActions.loadSummaryStatistics();\r\n\t}\r\n\t\r\n\t/** \r\n\t * Handles the user changing the currently selected tab\r\n\t * @param {Object} event - the HTML event representing the selection\r\n\t * @param {Number} value - the index of the new selected tab\r\n\t */\r\n\t_onChangeTab = (event, value) => {\r\n\t\tthis.setState({\r\n\t\t\tselectedTab: value\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user selecting the option to view ratings in textual format\r\n\t */\r\n\t_selectTextDescription = () => {\r\n\t\tthis.setState({\r\n\t\t\ttextDescription: true\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Handles the user selecting the option to view ratings in numeric format\r\n\t */\r\n\t_selectNumericDescription = () => {\r\n\t\tthis.setState({\r\n\t\t\ttextDescription: false\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * Renders a summary card\r\n\t * @param {String} title - the card header\r\n\t * @param {Number} value - the value of the card statistic\r\n\t * @return {JSX} - the rendered summary card\r\n\t */\r\n\trenderCard(title, value) {\r\n\t\treturn (\r\n\t\t\t<Grid item xs>\r\n\t\t\t\t<Card className=\"card\">\r\n\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t<h3 data-contributions-value={value}>\r\n\t\t\t\t\t\t\t{value}\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t{title}\r\n\t\t\t\t\t</CardContent>\r\n\t\t\t\t</Card>\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renders the contributions by date table\r\n\t */\r\n\trenderContributionsByDate() {\r\n\t\tconst data = this.state.contributionsByMonth.map((contribution) => {\r\n\t\t\treturn {\r\n\t\t\t\tmonth: parseInt(contribution.monthYear.split(\"/\")[0]),\r\n\t\t\t\tyear: parseInt(contribution.monthYear.split(\"/\")[1]),\r\n\t\t\t\tamount: contribution.contributions\r\n\t\t\t};\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<BootstrapTable data={data} pagination={data.length > 30} keyField=\"a\">\r\n\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='month' dataSort dataFormat={DateUtilities.getMonthName}>Month</TableHeaderColumn>\r\n\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='year' dataSort>Year</TableHeaderColumn>\r\n\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='amount' dataSort>Contributions</TableHeaderColumn>\r\n\t\t\t</BootstrapTable>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renders the contributions by month chart\r\n\t */\r\n\trenderContributionsChart() {\r\n\t\tconst data = {\r\n\t\t\tlabels: this.state.contributionsByMonth.map((contribution) => {\r\n\t\t\t\tconst split = contribution.monthYear.split(\"/\");\r\n\t\t\t\treturn `${DateUtilities.getMonthName(parseInt(split[0]))} ${split[1]}`;\r\n\t\t\t}),\r\n\t\t\tdatasets: [{\r\n\t\t\t\tlabel: \"Contributions By Month\",\r\n\t\t\t\tdata: this.state.contributionsByMonth.map((contribution) => {\r\n\t\t\t\t\treturn contribution.contributions;\r\n\t\t\t\t}),\r\n\t\t\t\tbackgroundColor: \"purple\"\r\n\t\t\t}]\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<Line data={data} options={{\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tdisplay: false\r\n\t\t\t\t},\r\n\t\t\t\tscales: {\r\n\t\t\t\t yAxes: [{\r\n\t\t\t\t\tgridLines: {\r\n\t\t\t\t\t\tdisplay: false\r\n\t\t\t\t\t}  \r\n\t\t\t\t  }]\r\n\t\t\t\t },\r\n\t\t\t}} />\r\n\t\t);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renders everything on the contributions tab\r\n\t */\r\n\trenderContributions() {\r\n\t\tif (!this.state.contributionsByMonth) {\r\n\t\t\treturn <LoaderComponent />;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div data-summary-contributions className=\"contributions\">\r\n\t\t\t\t<Grid container spacing={16}>\r\n\t\t\t\t\t{this.renderCard(\"Total Ratings\", this.state.totalRatings)}\r\n\t\t\t\t\t{this.renderCard(\"Total Comments\", this.state.totalComments)}\r\n\t\t\t\t\t{this.renderCard(\"Total Images\", this.state.totalImagesUploaded)}\r\n\t\t\t\t\t{this.renderCard(\"Contributions\", this.state.totalImagesUploaded + this.state.totalRatings + this.state.totalComments)}\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<div className=\"table\">\r\n\t\t\t\t\t{this.renderContributionsByDate()}\r\n\t\t\t\t</div>\r\n\t\t\t\t{this.renderContributionsChart()}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renders the format selection row in the sidewalk details tab\r\n\t */\r\n\trenderFormatSelection() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t <Radio\r\n\t\t\t\t  checked={this.state.textDescription}\r\n\t\t\t\t  onChange={this._selectTextDescription}\r\n\t\t\t\t  value=\"Text\"\r\n\t\t\t\t  name=\"text-description\"\r\n\t\t\t\t  aria-label=\"text\"\r\n\t\t\t\t  color=\"primary\"\r\n\t\t\t\t/>\r\n\t\t\t\t<span className=\"formLabel\" onClick={this._selectTextDescription}>Text</span>\r\n\t\t\t\t<Radio\r\n\t\t\t\t  checked={!this.state.textDescription}\r\n\t\t\t\t  onChange={this._selectNumericDescription}\r\n\t\t\t\t  value=\"Numeric\"\r\n\t\t\t\t  name=\"numeric-description\"\r\n\t\t\t\t  aria-label=\"numeric\"\r\n\t\t\t\t  color=\"primary\"\r\n\t\t\t\t/>\r\n\t\t\t\t<span className=\"formLabel\" onClick={this._selectNumericDescription}>Numeric</span>\r\n\t\t\t\t\r\n\t\t\t\t{this.state.csvFormatted && this.state.isLoggedIn && <CSVLink data={this.state.csvFormatted}>\r\n\t\t\t\t\t<Button bsStyle=\"primary\" className=\"csvButton\">\r\n\t\t\t\t\t\tExport CSV\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</CSVLink>}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renders everything on the sidewalk details tab\r\n\t */\r\n\trenderSidewalkDetails() {\r\n\t\tif (!this.state.sidewalkSummary) {\r\n\t\t\treturn <LoaderComponent />;\r\n\t\t}\r\n\t\t\r\n\t\tconst data = this.state.sidewalkSummary.sidewalks;\r\n\t\tconst formatFunc = (cell) => {\r\n\t\t\tif (this.state.textDescription) {\r\n\t\t\t\treturn getRatingDescription(cell);\r\n\t\t\t}\r\n\t\t\treturn round(cell);\r\n\t\t};\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className=\"sidewalkDetails\">\r\n\t\t\t\t{this.renderFormatSelection()}\r\n\t\t\t\t<BootstrapTable data={data} pagination={data.length > 100} keyField=\"id\" options={{sizePerPage: 100}}>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='id' dataSort>ID</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='comments' dataSort>Comments</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='images' dataSort>Images</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='ratings' dataSort>Ratings</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='accessibility' dataSort dataFormat={formatFunc}>Accessibility</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='connectivity' dataSort dataFormat={formatFunc}>Connectivity</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='comfort' dataSort dataFormat={formatFunc}>Comfort</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='physicalSafety' dataSort dataFormat={formatFunc}>Physical Safety</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='senseOfSecurity' dataSort dataFormat={formatFunc}>Sense of Security</TableHeaderColumn>\r\n\t\t\t\t\t<TableHeaderColumn className=\"lightFontWeight\" dataField='overallRating' dataSort dataFormat={formatFunc}>Overall Rating</TableHeaderColumn>\r\n\t\t\t\t</BootstrapTable>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Renders the currently selected tab\r\n\t */\r\n\trenderSelectedTab() {\r\n\t\tif (this.state.selectedTab === 0) {\r\n\t\t\treturn this.renderContributions();\r\n\t\t}\r\n\t\treturn this.renderSidewalkDetails();\r\n\t}\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div data-summary-stats className=\"statsPanel\">\r\n\t\t\t\t<Paper>\r\n\t\t\t\t\t<Tabs\r\n\t\t\t\t\t  value={this.state.selectedTab}\r\n\t\t\t\t\t  onChange={this._onChangeTab}\r\n\t\t\t\t\t  indicatorColor=\"primary\"\r\n\t\t\t\t\t  textColor=\"primary\"\r\n\t\t\t\t\t  centered\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  <Tab label=\"Overall Contributions\" />\r\n\t\t\t\t\t  <Tab label=\"Sidewalk Details\" />\r\n\t\t\t\t\t</Tabs>\r\n\t\t\t    </Paper>\r\n\t\t\t\t{this.renderSelectedTab()}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}","import React, { Component } from 'react';\r\nimport { Switch, Route } from 'react-router-dom';\r\nimport './style/App.scss';\r\n\r\nimport MapDashboard from \"./map/MapDashboard\";\r\nimport AboutPageView from \"./misc-components/AboutPageView\";\r\nimport AdminPanelView from \"./admin/AdminPanelView\";\r\nimport NavbarComponent from \"./misc-components/NavbarComponent\";\r\nimport AdminLogin from \"./admin/AdminLogin\";\r\nimport SummaryStatisticsView from \"./summary/SummaryStatisticsView\";\r\n\r\nclass App extends Component {\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <NavbarComponent />\r\n        <Switch>\r\n          <Route path=\"/about/\" component={AboutPageView} />\r\n          <Route path=\"/statistics\" component={SummaryStatisticsView} />\r\n          <Route path=\"/login\" component={AdminLogin} />\r\n          <Route path=\"/map/:id\" component={MapDashboard} />\r\n          <Route path=\"/dashboard\" component={AdminPanelView} />\r\n          <Route path=\"/\" component={MapDashboard} />\r\n        </Switch>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App\r\n","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n\r\n              // Execute callback\r\n              if (config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./style/index.css\";\r\nimport App from \"./App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\nimport { BrowserRouter } from \"react-router-dom\";\r\n\r\nimport { createMuiTheme, MuiThemeProvider } from \"@material-ui/core/styles\";\r\nimport purple from \"@material-ui/core/colors/purple\";\r\nimport {SECONDARY_COLOUR} from \"./constants/ThemeConstants\";\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: purple,\r\n\t\tsecondary: {\r\n\t\t\tmain: SECONDARY_COLOUR,\r\n\t\t}\r\n\t},\r\n\ttypography: {\r\n\t\tuseNextVariants: true,\r\n\t\tfontSize: \"24px\"\r\n\t}\r\n});\r\n\r\nReactDOM.render(\r\n\t<BrowserRouter>\r\n\t\t<MuiThemeProvider theme={theme}>\r\n\t\t\t<App />\r\n\t\t</MuiThemeProvider>\r\n\t</BrowserRouter>,\r\n\tdocument.getElementById(\"root\")\r\n);\r\n\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}